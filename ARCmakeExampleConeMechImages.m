%%

LMSweights = [0.5467    0.2533   -1.0000; ...
              0.4725    0.5775   -1.0000; ...
              0.7650    0.1350   -0.5000; ...
              1.1475    0.2025   -1.0000; ...
              0.2267    0.5733   -1.0000; ...
              0.3008    0.6492   -1.0000; ...
              1.1050    0.1950   -1.0000; ...
              1.1433    0.2567   -0.2500];

%%

LMweights = [0.8250    0.1750         0; ...
             0.8500    0.1500         0; ...
             0.8500    0.1500         0; ...
             0.8500    0.1500         0; ...
             0.2500    0.7500         0; ...
             0.8250    0.1750         0; ...
             0.8500    0.1500         0; ...
             0.7500    0.2500         0];

%%

LminusMweights = [0.3250   -0.1750         0; ...
                  0.3750   -0.1250         0; ...
                  0.4125   -0.0875         0; ...
                  0.8000   -0.2000         0; ...
                  0.7000   -0.3000         0; ...
                  0.4000   -0.1000         0; ...
                  0.6250   -0.3750         0; ...
                  0.4875   -0.0125         0];

%%

subjNumAll = [1 3 5 10 16 17 18 20];
wvInFocusLMS8 = [];
wvInFocusLM8 = [];
wvInFocusLminusM8 = [];
wvInFocusLMS1 = [];
wvInFocusLM1 = [];
wvInFocusLminusM1 = [];
wvInFocusLMS6 = [];
wvInFocusLM6 = [];
wvInFocusLminusM6 = [];
peakCorr8 = [];

for i = 1:size(LMSweights,1)
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),8,LMSweights(i,:),[]);
    wvInFocusLMS8(i,:) = wvInFocus;
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),8,[0.72 0.28 0],[]);
    wvInFocusLM8(i,:) = [wvInFocus wvInFocus2];
    peakCorr8(i,:) = peakCorr;
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),8,LminusMweights(i,:),[]);
    wvInFocusLminusM8(i,:) = wvInFocus; 

    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),1,LMSweights(i,:),[]);
    wvInFocusLMS1(i,:) = wvInFocus;
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),1,[0.72 0.28 0],[]);
    wvInFocusLM1(i,:) = [wvInFocus wvInFocus2];
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),1,LminusMweights(i,:),[]);
    wvInFocusLminusM1(i,:) = wvInFocus;

    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),6,LMSweights(i,:),[]);
    wvInFocusLMS6(i,:) = wvInFocus;
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),6,[0.72 0.28 0],[]);
    wvInFocusLM6(i,:) = [wvInFocus wvInFocus2];
    [wvInFocus, coneImgFilteredEg, coneImgOrigFilteredEg, wvInFocus2, wave, peakCorr] = ...
     ARCwvInFocusConesMeanZsandbox(subjNumAll(i),6,LminusMweights(i,:),[]);
    wvInFocusLminusM6(i,:) = wvInFocus;    

    disp(['Subj ' num2str(i) ' done']);
end


%%

% redblue = make_red_blue_colormap(1);
% axisLims = [min([LMSmechImg(:); LMmechImg(:); LminusMmechImg(:)]) max([LMSmechImg(:); LMmechImg(:); LminusMmechImg(:)])];
% figure; imagesc(LMSmechImg); axis square; colormap(redblue); xlim([50 120]); ylim([55 125]); colorbar; caxis(axisLims(2).*[-1 1])
% figure; imagesc(LMmechImg); axis square; colormap(redblue); xlim([50 120]); ylim([55 125]); colorbar; caxis(axisLims(2).*[-1 1])

