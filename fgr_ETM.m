%211102 floating error bar

%% AJR 
ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
     "S10003Right_ETMg_ACL0_C20_2107131605",...
     "S10003Right_ETMg_ACL0_C20_2107141524",...
     "S10003Right_ETMg_ACL0_C20_2107211606",...
        ]; 
    
ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
    "S10003Right_ETMp_ACL0_C20_2107131610",...
    "S10003Right_ETMp_ACL0_C20_2107141522",...
    "S10003Right_ETMp_ACL0_C20_2107211603",...
     ];  
 
aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
    "S10003Right_ETMw_ACL0_C20_2107131602",...
    "S10003Right_ETMw_ACL0_C20_2107141529",...
    "S10003Right_ETMw_ACL0_C20_2107211611",...
     ]; 

%%20%contrast mark 210621
ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
    "S10003Right_ETMg_ACL1_C20_2107131523",...
    "S10003Right_ETMg_ACL1_C20_2107141551",...
    "S10003Right_ETMg_ACL1_C20_2107211536",...
        ]; 
    
    %20%contrast mark 210621
ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
    "S10003Right_ETMp_ACL1_C20_2107131520",...
    "S10003Right_ETMp_ACL1_C20_2107141556",...
    "S10003Right_ETMp_ACL1_C20_2107211541",...
     ]; 
 
aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
    "S10003Right_ETMw_ACL1_C20_2107131528",...
    "S10003Right_ETMw_ACL1_C20_2107141548",...
    "S10003Right_ETMw_ACL1_C20_2107211532",...
     ]; 
      
 
 %% NHI 
ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
     "S10007Right_ETMg_ACL0_C20_2107151642",...
     "S10007Right_ETMg_ACL0_C20_2107211219",...
     "S10007Right_ETMg_ACL0_C20_2107221552",...
        ]; 

aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
    "S10007Right_ETMw_ACL0_C20_2107151629",...
    "S10007Right_ETMw_ACL0_C20_2107211241",...
    "S10007Right_ETMw_ACL0_C20_2107221548",...
     ]; 

ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
    "S10007Right_ETMp_ACL0_C20_2107151635",...
    "S10007Right_ETMp_ACL0_C20_2107211249",...
    "S10007Right_ETMp_ACL0_C20_2107221542",...
     ]; 

%%20%contrast mark 210621
ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
    "S10007Right_ETMg_ACL1_C20_2107151406",...
    "S10007Right_ETMg_ACL1_C20_2107211330",...
    "S10007Right_ETMg_ACL1_C20_2107221612",...
        ]; 



aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
    "S10007Right_ETMw_ACL1_C20_2107151537",...
    "S10007Right_ETMw_ACL1_C20_2107211410",...
    "S10007Right_ETMw_ACL1_C20_2107221617",...
     ]; 
      

%20%contrast mark 210621
ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
    "S10007Right_ETMp_ACL1_C20_2107151526",...
    "S10007Right_ETMp_ACL1_C20_2107211404",...
    "S10007Right_ETMp_ACL1_C20_2107221609"...
     ]; 
 
 
%% MSB 
ag0=["S10004Left_ETMg_ACL0_C20_2107131415",... 
    "S10004Left_ETMg_ACL0_C20_2107141244",...
    "S10004Left_ETMg_ACL0_C20_2107141324",...
    "S10004Left_ETMg_ACL0_C20_2109101610",...
        ]; 

aw0=["S10004Left_ETMw_ACL0_C20_2107131411",...
    "S10004Left_ETMw_ACL0_C20_2107141251",...
    "S10004Left_ETMw_ACL0_C20_2107141314",...
    "S10004Left_ETMw_ACL0_C20_2109101615",...
     ]; 

ap0=["S10004Left_ETMp_ACL0_C20_2107131422",...
    "S10004Left_ETMp_ACL0_C20_2107141240",...
    "S10004Left_ETMp_ACL0_C20_2107141320",...
    "S10004Left_ETMp_ACL0_C20_2109101605",...
     ]; 

%%20%contrast mark 210621
ag1=["S10004Left_ETMg_ACL1_C20_2107140942",...
    "S10004Left_ETMg_ACL1_C20_2107141026",...
    "S10004Left_ETMg_ACL1_C20_2107141341",...
    "S10004Left_ETMg_ACL1_C20_2109101526",...
        ]; 

aw1=["S10004Left_ETMw_ACL1_C20_2107140956", ...
     "S10004Left_ETMw_ACL1_C20_2107141022",...
     "S10004Left_ETMw_ACL1_C20_2107141356",...
     "S10004Left_ETMw_ACL1_C20_2109101542",...
     ]; 
      
%20%contrast mark 210621
ap1=["S10004Left_ETMp_ACL1_C20_2107141003",...
    "S10004Left_ETMp_ACL1_C20_2107141015",...
    "S10004Left_ETMp_ACL1_C20_2107141403",...
    "S10004Left_ETMp_ACL1_C20_2109101550",...
     ]; 
 
 
 %population
 ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
     "S10003Right_ETMg_ACL0_C20_2107131605",...
     "S10003Right_ETMg_ACL0_C20_2107141524",...
     "S10003Right_ETMg_ACL0_C20_2107211606",...
     "S10007Right_ETMg_ACL0_C20_2107081253",... 
     "S10007Right_ETMg_ACL0_C20_2107151642",...
     "S10007Right_ETMg_ACL0_C20_2107211219",...
     "S10007Right_ETMg_ACL0_C20_2107221552",...
     "S10004Left_ETMg_ACL0_C20_2107131415",... 
    "S10004Left_ETMg_ACL0_C20_2107141244",...
    "S10004Left_ETMg_ACL0_C20_2107141324",...
    "S10004Left_ETMg_ACL0_C20_2109101610",...
        ]; 
    
ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
    "S10003Right_ETMp_ACL0_C20_2107131610",...
    "S10003Right_ETMp_ACL0_C20_2107141522",...
    "S10003Right_ETMp_ACL0_C20_2107211603",...
    "S10007Right_ETMp_ACL0_C20_2107081336",...
    "S10007Right_ETMp_ACL0_C20_2107151635",...
    "S10007Right_ETMp_ACL0_C20_2107211249",...
    "S10007Right_ETMp_ACL0_C20_2107221542",... 
    "S10004Left_ETMp_ACL0_C20_2107131422",...
    "S10004Left_ETMp_ACL0_C20_2107141240",...
    "S10004Left_ETMp_ACL0_C20_2107141320",...
    "S10004Left_ETMp_ACL0_C20_2109101605",...
     ];  
 
aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
    "S10003Right_ETMw_ACL0_C20_2107131602",...
    "S10003Right_ETMw_ACL0_C20_2107141529",...
    "S10003Right_ETMw_ACL0_C20_2107211611",...
    "S10007Right_ETMw_ACL0_C20_2107081325",...
    "S10007Right_ETMw_ACL0_C20_2107151629",...
    "S10007Right_ETMw_ACL0_C20_2107211241",...
    "S10007Right_ETMw_ACL0_C20_2107221548",...
    "S10004Left_ETMw_ACL0_C20_2107131411",...
    "S10004Left_ETMw_ACL0_C20_2107141251",...
    "S10004Left_ETMw_ACL0_C20_2107141314",...
    "S10004Left_ETMw_ACL0_C20_2109101615",...
     ]; 

%%20%contrast mark 210621
ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
    "S10003Right_ETMg_ACL1_C20_2107131523",...
    "S10003Right_ETMg_ACL1_C20_2107141551",...
    "S10003Right_ETMg_ACL1_C20_2107211536",...
    "S10007Right_ETMg_ACL1_C20_2107081522",...
    "S10007Right_ETMg_ACL1_C20_2107151406",...
    "S10007Right_ETMg_ACL1_C20_2107211330",...
    "S10007Right_ETMg_ACL1_C20_2107221612",...
    "S10004Left_ETMg_ACL1_C20_2107140942",...
    "S10004Left_ETMg_ACL1_C20_2107141026",...
    "S10004Left_ETMg_ACL1_C20_2107141341",...
    "S10004Left_ETMg_ACL1_C20_2109101526",...
        ]; 
    
    %20%contrast mark 210621
ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
    "S10003Right_ETMp_ACL1_C20_2107131520",...
    "S10003Right_ETMp_ACL1_C20_2107141556",...
    "S10003Right_ETMp_ACL1_C20_2107211541",...
    "S10007Right_ETMp_ACL1_C20_2107081509",...
    "S10007Right_ETMp_ACL1_C20_2107151526",...
    "S10007Right_ETMp_ACL1_C20_2107211404",...
    "S10007Right_ETMp_ACL1_C20_2107221609"...
    "S10004Left_ETMp_ACL1_C20_2107141003",...
    "S10004Left_ETMp_ACL1_C20_2107141015",...
    "S10004Left_ETMp_ACL1_C20_2107141403",...
    "S10004Left_ETMp_ACL1_C20_2109101550",...
     ]; 
 
aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
    "S10003Right_ETMw_ACL1_C20_2107131528",...
    "S10003Right_ETMw_ACL1_C20_2107141548",...
    "S10003Right_ETMw_ACL1_C20_2107211532",...
    "S10007Right_ETMw_ACL1_C20_2107081517", ...
    "S10007Right_ETMw_ACL1_C20_2107151537",...
    "S10007Right_ETMw_ACL1_C20_2107211410",...
    "S10007Right_ETMw_ACL1_C20_2107221617",...
    "S10004Left_ETMw_ACL1_C20_2107140956", ...
     "S10004Left_ETMw_ACL1_C20_2107141022",...
     "S10004Left_ETMw_ACL1_C20_2107141356",...
     "S10004Left_ETMw_ACL1_C20_2109101542",...
     ]; 
      
 
 
 
 
%% CONVENTIONAL ANALYSIS using all the staircasses at once in psignfit CONVENTIONAL ANALYSIS
[w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
[w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 

[w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;  L0T1p=r11;       
[w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;  L1T1p=r11;
            
[w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00;  L0T1w=r11;     
[w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00;  L1T1w=r11;        
 
%% plot histogram with errorbars
r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count

cls; %%LOGSCALE
r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
r=3; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
r=3; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
%% END conventional analysis starting at line 56
% 
% 
% 
% 

%% analysis for LINEAR ANOVA
[w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
[w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 

[w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
[w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
            
[w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
[w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
  
 
cls; %% plot histogram with errorbars
r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
%save('OBSVR_PPL210926LNR', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')

cls; %ANALYSIS for LOGSCALE ANOVA

[w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
[w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 

[w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
[w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
            
[w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
[w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
  
r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
r=5; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
r=5; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
%save('OBSVR_PPL210926LOG', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')
%% END ANOVA analysis
% 
% 
x=[1:length(y)];
X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
%Y = [10 21 33 52];

b=bar(X, y);
%b=plot(X, y);
%% setup bar colors
b.FaceColor = 'flat';
c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 



%% set up number of trials at top of bar
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(yC);
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom');

hold on

er = errorbar(x, y, y-yL, yH-y);    
er.Color = [0 0 0];                            
er.LineStyle = 'none';
er.Marker='Square'
er.MarkerSize=20
er.MarkerEdgeColor

hold off


title(ttl)
ylabel(ylbl)


ttl='PPL210928LNR'
ylbl='MAR Acuity'
%save('ANOVA_PPL210928LNR')

ttl='PPL210928LOG'
ylbl='LogMAR Acuity'
%save('ANOVA_PPL210928LOG')

ylabel('MAR Acuity')

%LOGSCALE 
% set(gca, 'YScale', 'log'); 
% ylim manual; er.LData = er.YData - max(eps,er.YData-er.LData);
ylabel('LogMAR Acuity')
% 
%  
 %% 3way ANOVA for unbalanced design color m p
hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']; 
ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
     repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
     repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
     repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
     repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
     ];
 
 TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
      repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
      repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
      repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
      repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
     ];
 
 CLR=[repmat('M', [length(mL0T0g) 1]); repmat('M', [length( mL1T0g) 1]);...
      repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
      repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
      repmat('P', [length(mL0T0w) 1]); repmat('P', [length( mL1T0w) 1]);...
      repmat('P', [length(mL0T1w) 1]); repmat('P', [length( mL1T1w) 1]);...
     ];
%[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 1, 'model', 'interaction') 

[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 2, 'model', 'interaction') 

[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 3, 'model', 'interaction') 

results = multcompare(stats,'Dimension',[1 2 3]);

t=table(ACL, TCA, CLR, hg,...
    'VariableNames', {'ACL', 'TCA', 'CLR', 'VA'})
t.ACL = categorical(cellstr(t.ACL));
t.CLR = categorical(cellstr(t.CLR));
t.TCA = categorical(cellstr(t.TCA));

glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')

glme1 = fitglme(t,'VA ~ ACL + TCA + CLR', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')


%CLR
%% 3way ANOVA for unbalanced design color: r g b
hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
     repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
     repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
     repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
     repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
     ];
 
 TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
      repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
      repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
      repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
      repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
     ];
 
 CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
      repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
      repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
      repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
      repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
     ];

%[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 1, 'model', 'interaction') 

[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 2, 'model', 'interaction') 

[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 3, 'model', 'interaction') 

results = multcompare(stats,'Dimension',[1 2 3]);

t=table(ACL, TCA, CLR, hg,...
    'VariableNames', {'ACL', 'TCA', 'CLR', 'VA'})
t.ACL = categorical(cellstr(t.ACL));
t.CLR = categorical(cellstr(t.CLR));
t.TCA = categorical(cellstr(t.TCA));

glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')

glme1 = fitglme(t,'VA ~ ACL + TCA + CLR', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')


glme1 = fitglme(t,'VA ~ ACL + CLR + (1|TCA) + (1|TCA:CLR)', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')

glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects','CovariancePattern',{'Full','Diagonal'})


hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']

cls; hist(hg)
cls; 
subplot(3,4,1); hist(hg); title('AJR');
subplot(3,4,2); hist(mL0T0g); title('A0T0g');
subplot(3,4,3); hist(mL1T0g); title('A1T0g');
subplot(3,4,4); hist(mL0T0p); title('A0T0p');
subplot(3,4,5); hist(mL1T0p); title('A1T0p');
subplot(3,4,6); hist(mL0T1p); title('A0T1p');
subplot(3,4,7); hist(mL1T1p); title('A1T1p');
subplot(3,4,8); hist(mL0T0w); title('A0T0w');
subplot(3,4,9); hist(mL1T0w); title('A1T0w');
subplot(3,4,10); hist(mL0T1w); title('A0T1w');
subplot(3,4,11); hist(mL1T1w); title('A1T1w');

 % %ttest statistics
 %
%Is VA better with monochromatic vs equiluminant (purplish) light?
[h,p] =ttest2([mL0T0g], [mL0T0p]) 

%Is VA better with monochromatic vs white light?
[h,p] =ttest2([mL0T0g], [mL0T0w ]) 

%Is VA better with monochromatic vs polychromatic light?
[h,p] =ttest2([mL0T0g], [mL0T0p mL0T0w]) 

%Does visual acuity benefit by correcting longitudinal chromatic aberration for monochromatic stimuli?
[h,p] =ttest2([mL0T0g], [mL1T0g]) 

%Does visual acuity benefit by correcting LCA for equiluminant (purplish) stimuli?
[h,p] =ttest2([mL0T0p], [mL1T0p]) 

%Does visual acuity benefit by correcting LCA for white stimuli?
[h,p] =ttest2([mL0T0w], [mL1T0w]) 

%Does visual acuity benefit by correcting LCA for polychromatic stimuli?
[h,p] =ttest2([mL0T0p mL0T0w], [mL1T0p mL1T0w]) 

%Does visual acuity benefit by correcting TCA for equiluminant (purplish) stimuli?
[h,p] =ttest2([mL0T0p], [mL0T1p])

%Does visual acuity benefit by correcting TCA for white stimuli?
[h,p] =ttest2([mL0T0w], [mL0T1w])

%Does visual acuity benefit by correcting TCA for polychromatic stimuli?
[h,p] =ttest2([mL0T0w mL0T0p], [mL0T1w mL0T1p])

%Does visual acuity benefit by correcting LCA&TCA for equiluminant (purplish) stimuli?
[h,p] =ttest2([mL0T0p], [mL1T1p])

%Does visual acuity benefit by correcting LCA&TCA for white stimuli?
[h,p] =ttest2([mL0T0w], [mL1T1w])

%Does visual acuity benefit by correcting LCA&TCA for polychromatic stimuli?
[h,p] =ttest2([mL0T0w mL0T0p], [mL1T1w mL1T1p])

%Is there any difference between VA for monochromatic light vs TCA and LCA corrected polychromatic light? 
[h,p] =ttest2([mL0T0g mL1T0g], [mL1T1w mL1T1p])

%Does the presence of LCA make VA worse?
[h,p] =ttest2([mL0T0g], [mL0T0w mL0T0p])



[h,p] =ttest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]) %A0T0 vs A1T0
[h,p] =ttest2([mL0T0p], [mL1T0p]) %A0T0 vs A1T0 p
[h,p] =ttest2([mL0T0w], [mL1T0w]) %A0T0 vs A1T0 w

[h,p] =ttest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]) %A0T0 vs A1T1
[h,p] =ttest2([mL0T0p], [mL1T1p]) %A0T0 vs A1T1 p
[h,p] =ttest2([mL0T0w], [mL1T1w]) %A0T0 vs A1T1 w

[h,p] =ttest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1)
[h,p] =ttest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]) %(A0T0-A0T1) vs (A1T0-A1T1) p
[h,p] =ttest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1) w





%  % %ttest statistics
% [h,p] =kstest2([mL0T0p  mL0T0w], [mL0T1p mL0T1w]) %A0T0 vs A0T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL0T1p]) %A0T0 vs A0T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL0T1w]) %A0T0 vs A0T1 w
% % 
% % 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]) %A0T0 vs A1T0
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T0p]) %A0T0 vs A1T0 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T0w]) %A0T0 vs A1T0 w
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]) %A0T0 vs A1T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T1p]) %A0T0 vs A1T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T1w]) %A0T0 vs A1T1 w
% 
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]) %(A0T0-A0T1) vs (A1T0-A1T1) p
% [h,p,ks2stat] =kstest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1) w





% %211013 add population and posthovk analysis
% 
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%      ]; 
%       
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%      ]; 
%  
%  
% %% MSB 
% ag0=["S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     "S10004Left_ETMg_ACL0_C20_2109101610",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     "S10004Left_ETMw_ACL0_C20_2109101615",...
%      ]; 
% 
% ap0=["S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     "S10004Left_ETMp_ACL0_C20_2109101605",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     "S10004Left_ETMg_ACL1_C20_2109101526",...
%         ]; 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      "S10004Left_ETMw_ACL1_C20_2109101542",...
%      ]; 
%       
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     "S10004Left_ETMp_ACL1_C20_2109101550",...
%      ]; 
%  
%  
%  %population
%  ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%      "S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%      "S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     "S10004Left_ETMg_ACL0_C20_2109101610",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%     "S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",... 
%     "S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     "S10004Left_ETMp_ACL0_C20_2109101605",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%     "S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%     "S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     "S10004Left_ETMw_ACL0_C20_2109101615",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%     "S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%     "S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     "S10004Left_ETMg_ACL1_C20_2109101526",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%     "S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%     "S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     "S10004Left_ETMp_ACL1_C20_2109101550",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%     "S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%     "S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      "S10004Left_ETMw_ACL1_C20_2109101542",...
%      ]; 
%       
%  
%  
%  
%  
% %% CONVENTIONAL ANALYSIS using all the staircasses at once in psignfit CONVENTIONAL ANALYSIS
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;  L0T1p=r11;       
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;  L1T1p=r11;
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00;  L0T1w=r11;     
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00;  L1T1w=r11;        
%  
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% 
% cls; %%LOGSCALE
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END conventional analysis starting at line 56
% % 
% % 
% % 
% % 
% 
% %% analysis for LINEAR ANOVA
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %save('OBSVR_PPL210926LNR', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')
% 
% cls; %ANALYSIS for LOGSCALE ANOVA
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %save('OBSVR_PPL210926LOG', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')
% %% END ANOVA analysis
% % 
% % 
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% 
% title(ttl)
% ylabel(ylbl)
% 
% 
% ttl='PPL210928LNR'
% ylbl='MAR Acuity'
% %save('ANOVA_PPL210928LNR')
% 
% ttl='PPL210928LOG'
% ylbl='LogMAR Acuity'
% %save('ANOVA_PPL210928LOG')
% 
% ylabel('MAR Acuity')
% 
% %LOGSCALE 
% % set(gca, 'YScale', 'log'); 
% % ylim manual; er.LData = er.YData - max(eps,er.YData-er.LData);
% ylabel('LogMAR Acuity')
% % 
% %  
%  %% 3way ANOVA for unbalanced design color m p
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']; 
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('M', [length(mL0T0g) 1]); repmat('M', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('P', [length(mL0T0w) 1]); repmat('P', [length( mL1T0w) 1]);...
%       repmat('P', [length(mL0T1w) 1]); repmat('P', [length( mL1T1w) 1]);...
%      ];
% %[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 1, 'model', 'interaction') 
% 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 2, 'model', 'interaction') 
% 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 3, 'model', 'interaction') 
% 
% results = multcompare(stats,'Dimension',[1 2 3]);
% 
% t=table(ACL, TCA, CLR, hg,...
%     'VariableNames', {'ACL', 'TCA', 'CLR', 'VA'})
% t.ACL = categorical(cellstr(t.ACL));
% t.CLR = categorical(cellstr(t.CLR));
% t.TCA = categorical(cellstr(t.TCA));
% 
% glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')
% 
% glme1 = fitglme(t,'VA ~ ACL + TCA + CLR', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')
% 
% 
% %CLR
% %% 3way ANOVA for unbalanced design color: r g b
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
%       repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
%      ];
% 
% %[p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 1, 'model', 'interaction') 
% 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 2, 'model', 'interaction') 
% 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}, 'sstype', 3, 'model', 'interaction') 
% 
% results = multcompare(stats,'Dimension',[1 2 3]);
% 
% t=table(ACL, TCA, CLR, hg,...
%     'VariableNames', {'ACL', 'TCA', 'CLR', 'VA'})
% t.ACL = categorical(cellstr(t.ACL));
% t.CLR = categorical(cellstr(t.CLR));
% t.TCA = categorical(cellstr(t.TCA));
% 
% glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')
% 
% glme1 = fitglme(t,'VA ~ ACL + TCA + CLR', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')
% 
% 
% glme1 = fitglme(t,'VA ~ ACL + CLR + (1|TCA) + (1|TCA:CLR)', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects')
% 
% glme1 = fitglme(t,'VA ~ ACL*TCA + TCA*CLR + CLR*ACL', 'Distribution','Normal','Link','identity', 'FitMethod','REMPL', 'DummyVarCoding','effects','CovariancePattern',{'Full','Diagonal'})
% 
% % 
% 
% 
% 
% 
% 
% 
% 
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% 
% cls; hist(hg)
% cls; 
% subplot(3,4,1); hist(hg); title('AJR');
% subplot(3,4,2); hist(mL0T0g); title('A0T0g');
% subplot(3,4,3); hist(mL1T0g); title('A1T0g');
% subplot(3,4,4); hist(mL0T0p); title('A0T0p');
% subplot(3,4,5); hist(mL1T0p); title('A1T0p');
% subplot(3,4,6); hist(mL0T1p); title('A0T1p');
% subplot(3,4,7); hist(mL1T1p); title('A1T1p');
% subplot(3,4,8); hist(mL0T0w); title('A0T0w');
% subplot(3,4,9); hist(mL1T0w); title('A1T0w');
% subplot(3,4,10); hist(mL0T1w); title('A0T1w');
% subplot(3,4,11); hist(mL1T1w); title('A1T1w');
% 





% %210811 add population and posthovk analysis
% 
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%      ]; 
%       
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%      ]; 
%  
%  
% %% MSB 
% ag0=["S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     "S10004Left_ETMg_ACL0_C20_2109101610",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     "S10004Left_ETMw_ACL0_C20_2109101615",...
%      ]; 
% 
% ap0=["S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     "S10004Left_ETMp_ACL0_C20_2109101605",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     "S10004Left_ETMg_ACL1_C20_2109101526",...
%         ]; 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      "S10004Left_ETMw_ACL1_C20_2109101542",...
%      ]; 
%       
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     "S10004Left_ETMp_ACL1_C20_2109101550",...
%      ]; 
%  
%  
%  %population
%  ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%      "S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%      "S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     "S10004Left_ETMg_ACL0_C20_2109101610",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%     "S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",... 
%     "S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     "S10004Left_ETMp_ACL0_C20_2109101605",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%     "S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%     "S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     "S10004Left_ETMw_ACL0_C20_2109101615",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%     "S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%     "S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     "S10004Left_ETMg_ACL1_C20_2109101526",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%     "S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%     "S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     "S10004Left_ETMp_ACL1_C20_2109101550",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%     "S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%     "S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      "S10004Left_ETMw_ACL1_C20_2109101542",...
%      ]; 
%       
%  
%  
%  
%  
% %% CONVENTIONAL ANALYSIS using all the staircasses at once in psignfit CONVENTIONAL ANALYSIS
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;  L0T1p=r11;       
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;  L1T1p=r11;
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00;  L0T1w=r11;     
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00;  L1T1w=r11;        
%  
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% 
% cls; %%LOGSCALE
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END conventional analysis starting at line 56
% % 
% % 
% % 
% % 
% 
% %% analysis for LINEAR ANOVA
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %save('OBSVR_PPL210926LNR', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')
% 
% cls; %ANALYSIS for LOGSCALE ANOVA
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM4(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %save('OBSVR_PPL210926LOG', 'mL0T0g', 'mL1T0g', 'mL0T0p', 'mL1T0p', 'mL0T1p', 'mL1T1p', 'mL0T0w', 'mL1T0w', 'mL0T1w', 'mL1T1w')
% %% END ANOVA analysis
% % 
% % 
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% 
% title(ttl)
% ylabel(ylbl)
% 
% 
% ttl='PPL210928LNR'
% ylbl='MAR Acuity'
% %save('ANOVA_PPL210928LNR')
% 
% ttl='PPL210928LOG'
% ylbl='LogMAR Acuity'
% %save('ANOVA_PPL210928LOG')
% 
% ylabel('MAR Acuity')
% 
% %LOGSCALE 
% % set(gca, 'YScale', 'log'); 
% % ylim manual; er.LData = er.YData - max(eps,er.YData-er.LData);
% ylabel('LogMAR Acuity')
% % 
% %  
%  %% 3way ANOVA for unbalanced design color m p
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']; 
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('M', [length(mL0T0g) 1]); repmat('M', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('P', [length(mL0T0w) 1]); repmat('P', [length( mL1T0w) 1]);...
%       repmat('P', [length(mL0T1w) 1]); repmat('P', [length( mL1T1w) 1]);...
%      ];
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
% results = multcompare(stats,'Dimension',[1 2 3]);
% % 
% %% 3way ANOVA for unbalanced design color: r g b
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
%       repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% % 
% % 
% % %KS statistics
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL0T1p mL0T1w]) %A0T0 vs A0T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL0T1p]) %A0T0 vs A0T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL0T1w]) %A0T0 vs A0T1 w
% % 
% % 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]) %A0T0 vs A1T0
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T0p]) %A0T0 vs A1T0 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T0w]) %A0T0 vs A1T0 w
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]) %A0T0 vs A1T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T1p]) %A0T0 vs A1T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T1w]) %A0T0 vs A1T1 w
% 
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]) %(A0T0-A0T1) vs (A1T0-A1T1) p
% [h,p,ks2stat] =kstest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1) w
% 
% m=[mL0T0g; mL1T0g; mL0T0p; mL0T1p; mL1T0p; mL1T1p; mL0T0w; mL0T1w; mL1T0w; mL1T1w]
% % Repeated measures NAOVA
% CLR=['G' 'G' 'P' 'P' 'P' 'P' 'W' 'W' 'W' 'W']'; 
% ACL=['0' '1' '0' '0' '1' '1' '0' '0' '1' '1']'; 
% TCA=['0' '0' '0' '1' '0' '1' '0' '1' '0' '1']'; 
% t=table(CLR, ACL, TCA, ...
%    m(:,1), m(:,2), m(:,3), m(:,4), m(:,5), m(:,6), m(:,7), m(:,8), m(:,9), m(:,10), m(:,11), m(:,12), m(:,13), m(:,14), m(:,15), m(:,16), m(:,17), m(:,18), m(:,19), m(:,20), m(:,21), m(:,22), m(:,23), m(:,24), ...
%     'VariableNames', {'CLR', 'ACL', 'TCA', 't1','t2','t3','t4','t5','t6', 't7', 't8', 't9', 't10', 't11', 't12', 't13','t14','t15','t16','t17','t18', 't19', 't20', 't21', 't22', 't23', 't24'})
% 
% Time = [1:24]';
% 
% rm = fitrm(t,'t1-t24 ~ CLR + ACL + TCA','WithinDesign',Time);
% ranovatbl = ranova(rm)
% 
% 
% 
% CLR=['M' 'M' 'P' 'P' 'P' 'P' 'P' 'P' 'P' 'P']'; 
% ACL=['0' '1' '0' '0' '1' '1' '0' '0' '1' '1']'; 
% TCA=['0' '0' '0' '1' '0' '1' '0' '1' '0' '1']'; 
% t=table(CLR, ACL, TCA, ...
%    m(:,1), m(:,2), m(:,3), m(:,4), m(:,5), m(:,6), m(:,7), m(:,8), m(:,9), m(:,10), m(:,11), m(:,12), m(:,13), m(:,14), m(:,15), m(:,16), m(:,17), m(:,18), m(:,19), m(:,20), m(:,21), m(:,22), m(:,23), m(:,24), ...
%     'VariableNames', {'CLR', 'ACL', 'TCA', 't1','t2','t3','t4','t5','t6', 't7', 't8', 't9', 't10', 't11', 't12', 't13','t14','t15','t16','t17','t18', 't19', 't20', 't21', 't22', 't23', 't24'})
% 
% Time = [1:24]';
% 
% rm = fitrm(t,'t1-t24 ~ CLR + ACL + TCA','WithinDesign',Time);
% ranovatbl = ranova(rm)
% 
% 
% 
% 
% 
% %repeated measures anova for AJR&NHI
% 
% m=[mL0T0g; mL1T0g; mL0T0p; mL0T1p; mL1T0p; mL1T1p; mL0T0w; mL0T1w; mL1T0w; mL1T1w]
% CLR=['G' 'G' 'P' 'P' 'P' 'P' 'W' 'W' 'W' 'W']'; 
% ACL=['0' '1' '0' '0' '1' '1' '0' '0' '1' '1']'; 
% TCA=['0' '0' '0' '1' '0' '1' '0' '1' '0' '1']'; 
% t=table(CLR, ACL, TCA, ...
%    m(:,1), m(:,2), m(:,3), m(:,4), m(:,5), m(:,6), m(:,7), m(:,8),...
%     'VariableNames', {'CLR', 'ACL', 'TCA', 't1','t2','t3','t4','t5','t6', 't7', 't8'})
% 
% Time = [1:8]';
% 
% rm = fitrm(t,'t1-t8 ~ CLR + ACL + TCA','WithinDesign',Time);
% ranovatbl = ranova(rm)
% 
% 
% 
% CLR=['M' 'M' 'P' 'P' 'P' 'P' 'P' 'P' 'P' 'P']'; 
% ACL=['0' '1' '0' '0' '1' '1' '0' '0' '1' '1']'; 
% TCA=['0' '0' '0' '1' '0' '1' '0' '1' '0' '1']'; 
% t=table(CLR, ACL, TCA, ...
%    m(:,1), m(:,2), m(:,3), m(:,4), m(:,5), m(:,6), m(:,7), m(:,8),...
%     'VariableNames', {'CLR', 'ACL', 'TCA', 't1','t2','t3','t4','t5','t6', 't7', 't8'})
% 
% Time = [1:8]';
% 
% rm = fitrm(t,'t1-t8 ~ CLR + ACL + TCA','WithinDesign',Time);
% ranovatbl = ranova(rm)
% 
% 
% 
% %Answering Austins' Qs
% %Is VA better with monochromatic vs equiluminant (purplish) light?
% [h,p,ks2stat] =kstest2(mL0T0g, mL0T0p) 
% 
% %Is VA better with monochromatic vs white light?
% [h,p,ks2stat] =kstest2(mL0T0g, mL0T0w) 
%  
% %Is VA better with monochromatic vs polychromatic light?
% [h,p,ks2stat] =kstest2(mL0T0g  , [mL0T0p mL0T0w]) 
% 
% %Does visual acuity benefit by correcting longitudinal chromatic aberration for monochromatic stimuli?
% [h,p,ks2stat] =kstest2(mL0T0g  , mL1T0g) 
% 
% %Does visual acuity benefit by correcting LCA for equiluminant (purplish) stimuli?
% [h,p,ks2stat] =kstest2(mL0T0p  , mL1T0p) 
% 
% %Does visual acuity benefit by correcting LCA for white stimuli?
% [h,p,ks2stat] =kstest2(mL0T0w  , mL1T0w) 
% 
% %Does visual acuity benefit by correcting LCA for polychromatic stimuli?
% [h,p,ks2stat] =kstest2([mL0T0w mL0T0p]  , [mL1T0w mL1T0p]) 
% 
% %Does visual acuity benefit by correcting TCA for equiluminant (purplish) stimuli?
% [h,p,ks2stat] =kstest2(mL0T0p  , mL0T1p) 
% 
% %Does visual acuity benefit by correcting TCA for white stimuli?
% [h,p,ks2stat] =kstest2(mL0T0w  , mL0T1w) 
% 
% %Does visual acuity benefit by correcting TCA for polychromatic stimuli?
% [h,p,ks2stat] =kstest2([mL0T0w mL0T0p]  , [mL0T1w mL0T1p]) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for equiluminant (purplish) stimuli?
% [h,p,ks2stat] =kstest2(mL0T0p  , mL1T1p) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for white stimuli?
% [h,p,ks2stat] =kstest2(mL0T0w  , mL1T1w) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for polychromatic stimuli?
% [h,p,ks2stat] =kstest2([mL0T0w mL0T0p]  , [mL1T1w mL1T1p]) 
% 
% %Is there any difference between VA for monochromatic light vs TCA and LCA corrected polychromatic light? 
% [h,p,ks2stat] =kstest2([mL0T0g mL1T0g]  , [mL1T1w mL1T1p]) 
% 
% %Does the presence of LCA make VA worse?
% [h,p,ks2stat] =kstest2(mL0T0g  , [mL0T0w mL0T0p]) 
% 
% 
% 
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% 
% cls; hist(hg)
% cls; 
% subplot(3,4,1); hist(hg); title('AJR');
% subplot(3,4,2); hist(mL0T0g); title('A0T0g');
% subplot(3,4,3); hist(mL1T0g); title('A1T0g');
% subplot(3,4,4); hist(mL0T0p); title('A0T0p');
% subplot(3,4,5); hist(mL1T0p); title('A1T0p');
% subplot(3,4,6); hist(mL0T1p); title('A0T1p');
% subplot(3,4,7); hist(mL1T1p); title('A1T1p');
% subplot(3,4,8); hist(mL0T0w); title('A0T0w');
% subplot(3,4,9); hist(mL1T0w); title('A1T0w');
% subplot(3,4,10); hist(mL0T1w); title('A0T1w');
% subplot(3,4,11); hist(mL1T1w); title('A1T1w');
% 
% %TTEST
% %Answering Austins' Qs
% %Is VA better with monochromatic vs equiluminant (purplish) light?
% % [h,p,ci, stats] =ttest2(mL0T0g', mL0T0p') 
% % [h,p,ci, stats] =ttest2(mL0T0g', mL0T0p', 'Vartype', 'unequal') 
% [h,p,ci, stats] =ttest2(mL0T0g', mL0T0p') 
% 
% %Is VA better with monochromatic vs white light?
% [h,p,ci, stats] =ttest2(mL0T0g, mL0T0w) 
%  
% %Is VA better with monochromatic vs polychromatic light?
% [h,p,ci, stats] =ttest2(mL0T0g  , [mL0T0p mL0T0w]) 
% 
% %Does visual acuity benefit by correcting longitudinal chromatic aberration for monochromatic stimuli?
% [h,p,ci, stats] =ttest2(mL0T0g  , mL1T0g) 
% 
% %Does visual acuity benefit by correcting LCA for equiluminant (purplish) stimuli?
% [h,p,ci, stats] =ttest2(mL0T0p  , mL1T0p) 
% 
% %Does visual acuity benefit by correcting LCA for white stimuli?
% [h,p,ci, stats] =ttest2(mL0T0w  , mL1T0w) 
% 
% %Does visual acuity benefit by correcting LCA for polychromatic stimuli?
% [h,p,ci, stats] =ttest2([mL0T0w mL0T0p]  , [mL1T0w mL1T0p]) 
% 
% %Does visual acuity benefit by correcting TCA for equiluminant (purplish) stimuli?
% [h,p,ci, stats] =ttest2(mL0T0p  , mL0T1p) 
% 
% %Does visual acuity benefit by correcting TCA for white stimuli?
% [h,p,ci, stats] =ttest2(mL0T0w  , mL0T1w) 
% 
% %Does visual acuity benefit by correcting TCA for polychromatic stimuli?
% [h,p,ci, stats] =ttest2([mL0T0w mL0T0p]  , [mL0T1w mL0T1p]) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for equiluminant (purplish) stimuli?
% [h,p,ci, stats] =ttest2(mL0T0p  , mL1T1p) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for white stimuli?
% [h,p,ci, stats] =ttest2(mL0T0w  , mL1T1w) 
% 
% %Does visual acuity benefit by correcting LCA&TCA for polychromatic stimuli?
% [h,p,ci, stats] =ttest2([mL0T0w mL0T0p]  , [mL1T1w mL1T1p]) 
% 
% %Is there any difference between VA for monochromatic light vs TCA and LCA corrected polychromatic light? 
% [h,p,ci, stats] =ttest2([mL0T0g mL1T0g]  , [mL1T1w mL1T1p]) 
% 
% %Does the presence of LCA make VA worse?
% [h,p,ci, stats] =ttest2(mL0T0g'  , [mL0T0w mL0T0p]') 
% 
% 
% 
% 
% 
% [h,p,ci, stats] =ttest2([mL0T0p  mL0T0w], [mL0T1p mL0T1w]) %A0T0 vs A0T1
% [h,p,ci, stats] =ttest2([mL0T0p], [mL0T1p]) %A0T0 vs A0T1 p
% [h,p,ci, stats] =ttest2([mL0T0w], [mL0T1w]) %A0T0 vs A0T1 w
% % 
% [h,p,ci, stats] =ttest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]) %A0T0 vs A1T0
% [h,p,ci, stats] =ttest2([mL0T0p], [mL1T0p]) %A0T0 vs A1T0 p
% [h,p,ci, stats] =ttest2([mL0T0w], [mL1T0w]) %A0T0 vs A1T0 w
% 
% [h,p,ci, stats] =ttest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]) %A0T0 vs A1T1
% [h,p,ci, stats] =ttest2([mL0T0p], [mL1T1p]) %A0T0 vs A1T1 p
% [h,p,ci, stats] =ttest2([mL0T0w], [mL1T1w]) %A0T0 vs A1T1 w
% 
% [h,p,ci, stats] =ttest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1)
% [h,p,ci, stats] =ttest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]) %(A0T0-A0T1) vs (A1T0-A1T1) p
% [h,p,ci, stats] =ttest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]) %(A0T0-A0T1) vs (A1T0-A1T1) w
% 
% 




% %210811 add population and posthovk analysis
% 
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%      ]; 
%       
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%      ]; 
%  
%  
% %% MSB 
% ag0=["S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     %"S10004Left_ETMg_ACL0_C20_2108231414",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     %"S10004Left_ETMw_ACL0_C20_2108231409",...
%      ]; 
% 
% ap0=["S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     %"S10004Left_ETMp_ACL0_C20_2108231400",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     %"S10004Left_ETMg_ACL1_C20_2108231321",...
%         ]; 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      %"S10004Left_ETMw_ACL1_C20_2108231330",...
%      ]; 
%       
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     %"S10004Left_ETMp_ACL1_C20_2108231340",...
%      ]; 
%  
%  
%  %population
%  ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%      "S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%      "S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%     %"S10004Left_ETMg_ACL0_C20_2108231414",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%     "S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",... 
%     "S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%     %"S10004Left_ETMp_ACL0_C20_2108231400",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%     "S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%     "S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%     %"S10004Left_ETMw_ACL0_C20_2108231409",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%     "S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%     "S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%     %"S10004Left_ETMg_ACL1_C20_2108231321",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%     "S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%     "S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%     %"S10004Left_ETMp_ACL1_C20_2108231340",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%     "S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%     "S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      %"S10004Left_ETMw_ACL1_C20_2108231330",...bad data
%      ]; 
%       
%  
%  
%  
%  
% %% CONVENTIONAL ANALYSIS using all the staircasses at once in psignfit CONVENTIONAL ANALYSIS
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;  L0T1p=r11;       
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;  L1T1p=r11;
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00;  L0T1w=r11;     
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00;  L1T1w=r11;        
%  
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% 
% cls; %%LOGSCALE
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END conventional analysis starting at line 56
% 
% 
% 
% 
% 
% %% analysis for ANOVA
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% 
% cls; %LOGSCALE
% r=1, c=5; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=5; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END ANOVA analysis
% 
% 
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')
% 
% %LOGSCALE 
% % set(gca, 'YScale', 'log'); 
% % ylim manual; er.LData = er.YData - max(eps,er.YData-er.LData);
% ylabel('LogMAR Acuity')
% 
%  
% %% 3way ANOVA for unbalanced design color m p
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']; 
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('M', [length(mL0T0g) 1]); repmat('M', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('P', [length(mL0T0w) 1]); repmat('P', [length( mL1T0w) 1]);...
%       repmat('P', [length(mL0T1w) 1]); repmat('P', [length( mL1T1w) 1]);...
%      ];
% %LOGSCALE hg=log10(hg)
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'});
% results = multcompare(stats,'Dimension',[1 2 3]);
% 
% %% 3way ANOVA for unbalanced design color: r g b
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
%       repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
%      ];
% %LOGSCALE hg=log10(hg)
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% 
% 
% %KS statistics
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL0T1p mL0T1w]); %A0T0 -A0T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL0T1p]); %A0T0 -A0T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL0T1w]); %A0T0 -A0T1 w
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T0p]); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T0w]); %A0T0 -A1T0
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]); %A0T0 -A1T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T1p]);
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T1w]);
% 
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]); %(A0T0-A0T1) - (A1T0-A1T1)
% 
% 
% 
% %%LOGSCALE
% [h,p,ks2stat] =kstest2(log10([mL0T0p  mL0T0w]), log10([mL0T1p mL0T1w])); %A0T0 -A0T1
% [h,p,ks2stat] =kstest2(log10([mL0T0p]), log10([mL0T1p])); %A0T0 -A0T1 p
% [h,p,ks2stat] =kstest2(log10([mL0T0w]), log10([mL0T1w])); %A0T0 -A0T1 w
% 
% 
% [h,p,ks2stat] =kstest2(log10([mL0T0p  mL0T0w]), log10([mL1T0p mL1T0w])); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2(log10([mL0T0p]), log10([mL1T0p])); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2(log10([mL0T0w]), log10([mL1T0w])); %A0T0 -A1T0
% 
% [h,p,ks2stat] =kstest2(log10([mL0T0p  mL0T0w]), log10([mL1T1p mL1T1w])); %A0T0 -A1T1
% [h,p,ks2stat] =kstest2(log10([mL0T0p]), log10([mL1T1p]));
% [h,p,ks2stat] =kstest2(log10([mL0T0w]), log10([mL1T1w]));
% 
% [h,p,ks2stat] =kstest2(log10([mL0T0p-mL0T1p  mL0T0w-mL0T1w]), log10([mL1T0p-mL1T1p mL1T0w-mL1T1w])); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2(log10([mL0T0p-mL0T1p]), log10([mL1T0p-mL1T1p])); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2(log10([mL0T0w-mL0T1w]), log10([mL1T0w-mL1T1w])); %(A0T0-A0T1) - (A1T0-A1T1)
% 


% %KS statistics
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T0p  mL0T1p mL0T0w mL0T1w mL1T0p  mL1T1p mL1T0w  mL1T1w]); %mono vs poly
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL1T0p  mL1T1p mL1T0w  mL1T1w]); %mono vs LCA1
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T0p  mL0T1p mL0T0w mL0T1w]); %mono vs LCA0
% 
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T1p mL0T1w mL1T1p mL1T1w]); %mono vs TCA1
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T0p mL0T0w mL1T0p mL1T0w]); %mono vs TCA0
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T0p  mL0T1p mL0T0w mL0T1w mL1T0p mL1T0w]); %mono vs polyUN/HALFcorrected
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T1p mL0T1w mL1T0p mL1T0w]); %mono vs HALFcorrected
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL0T0p mL0T0w]); %mono vs LCA0&TCA0
% [h,p,ks2stat] =kstest2([mL0T0g  mL1T0g], [mL1T1p mL1T1w]); %mono vs LCA1&TCA1
% 
% 
% %WHITE
% [h,p,ks2stat] = kstest2(mL1T0g, mL1T1w) %A1T0g vs A1T1w
% [h,p,ks2stat] =kstest2(mL0T0g  , mL1T1w) %A0T0g vs A1T1w
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], mL1T1w) %A#T0g vs A1T1w
% 
% 
% [h,p,ks2stat] = kstest2(mL1T0g, mL0T1w) %A1T0g vs A0T1w
% [h,p,ks2stat] =kstest2(mL0T0g  , mL0T1w) %A0T0g vs A0T1w
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], mL0T1w); %A#T0g vs A0T1w
% 
% 
% [h,p,ks2stat] = kstest2(mL1T0g, mL1T0w) %A1T0g vs A1T0w
% [h,p,ks2stat] =kstest2(mL0T0g  , mL1T0w) %A0T0g vs A1T0w
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], mL1T0w); %A#T0g vs A1T0w
% 
% 
% [h,p,ks2stat] = kstest2(mL1T0g, mL0T0w) %A1T0g vs A1T0w
% [h,p,ks2stat] =kstest2(mL0T0g  , mL0T0w) %A0T0g vs A1T0w
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], mL0T0w) %A#T0g vs A1T0w
% 
% 
% 
% 
% [h,p,ks2stat] = kstest2(mL1T0g, mL1T1p)
% [h,p,ks2stat] =kstest2(mL0T0g  , mL1T1p)
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], mL1T1p)
% 
% [h,p,ks2stat] = kstest2(mL0T0g, [mL1T1w mL1T1p])
% [h,p,ks2stat] = kstest2(mL1T0g, [mL1T1w mL1T1p])
% 
% [h,p,ks2stat] = kstest2([mL0T0g  mL1T0g], [mL1T1w mL1T1p])
% 
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL0T1p mL0T1w]); %A0T0 -A0T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL0T1p]); %A0T0 -A0T1 p
% [h,p,ks2stat] =kstest2([mL0T0w], [mL0T1w]); %A0T0 -A0T1 w
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T0p mL1T0w]); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T0p]); %A0T0 -A1T0
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T0w]); %A0T0 -A1T0
% 
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T0w], [mL1T1p mL1T1w]); %A0T0 -A1T1
% [h,p,ks2stat] =kstest2([mL0T0p], [mL1T1p]);
% [h,p,ks2stat] =kstest2([mL0T0w], [mL1T1w]);
% 
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p  mL0T0w-mL0T1w], [mL1T0p-mL1T1p mL1T0w-mL1T1w]); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0p-mL0T1p], [mL1T0p-mL1T1p]); %(A0T0-A0T1) - (A1T0-A1T1)
% [h,p,ks2stat] =kstest2([mL0T0w-mL0T1w], [mL1T0w-mL1T1w]); %(A0T0-A0T1) - (A1T0-A1T1)
% 
% 
% [h,p,ks2stat] =kstest2([mL0T0g mL0T0p  mL0T1p mL0T0w mL0T1w], [mL1T0g mL1T0p  mL1T1p mL1T0w  mL1T1w]); %LCA0 vs LCA1
% [h,p,ks2stat] =kstest2([mL0T0p  mL0T1p mL0T0w mL0T1w], [mL1T0p  mL1T1p mL1T0w  mL1T1w]); %LCA0 vs LCA1
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL1T0w mL0T0w], [mL0T1p mL0T1w  mL1T1p mL1T1w]); %TCA0 vs TCA1
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL1T0w mL0T0w mL0T1p mL0T1w], [mL0T0g  mL1T0g  mL1T1p mL1T1w])
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL1T0w mL0T0w mL0T1p mL0T1w], [mL1T1p mL1T1w])
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL0T1p], [mL0T0g  mL1T0g  mL1T1p])
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL0T1p], [mL0T0g  mL1T0g mL1T1w])
% [h,p,ks2stat] =kstest2([mL0T0p mL1T0p mL0T1p], mL1T1p)
% [h,p,ks2stat] =kstest2([mL0T0w mL1T0w mL0T1w], mL1T1w)




% %210713 reintroduce psignfit using all trials as once along with ANOVA
% 
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%      "S10003Right_ETMg_ACL0_C20_2107141524",...
%      "S10003Right_ETMg_ACL0_C20_2107211606",...
%         ]; 
%     
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%     "S10003Right_ETMp_ACL0_C20_2107141522",...
%     "S10003Right_ETMp_ACL0_C20_2107211603",...
%      ];  
%  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%     "S10003Right_ETMw_ACL0_C20_2107141529",...
%     "S10003Right_ETMw_ACL0_C20_2107211611",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%     "S10003Right_ETMg_ACL1_C20_2107141551",...
%     "S10003Right_ETMg_ACL1_C20_2107211536",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%     "S10003Right_ETMp_ACL1_C20_2107141556",...
%     "S10003Right_ETMp_ACL1_C20_2107211541",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%     "S10003Right_ETMw_ACL1_C20_2107141548",...
%     "S10003Right_ETMw_ACL1_C20_2107211532",...
%      ]; 
%       
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%      "S10007Right_ETMg_ACL0_C20_2107151642",...
%      "S10007Right_ETMg_ACL0_C20_2107211219",...
%      "S10007Right_ETMg_ACL0_C20_2107221552",...
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%     "S10007Right_ETMw_ACL0_C20_2107151629",...
%     "S10007Right_ETMw_ACL0_C20_2107211241",...
%     "S10007Right_ETMw_ACL0_C20_2107221548",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%     "S10007Right_ETMp_ACL0_C20_2107151635",...
%     "S10007Right_ETMp_ACL0_C20_2107211249",...
%     "S10007Right_ETMp_ACL0_C20_2107221542",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%     "S10007Right_ETMg_ACL1_C20_2107151406",...
%     "S10007Right_ETMg_ACL1_C20_2107211330",...
%     "S10007Right_ETMg_ACL1_C20_2107221612",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%     "S10007Right_ETMw_ACL1_C20_2107151537",...
%     "S10007Right_ETMw_ACL1_C20_2107211410",...
%     "S10007Right_ETMw_ACL1_C20_2107221617",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%     "S10007Right_ETMp_ACL1_C20_2107151526",...
%     "S10007Right_ETMp_ACL1_C20_2107211404",...
%     "S10007Right_ETMp_ACL1_C20_2107221609"...
%      ]; 
%  
%  
% %% MSB 
% ag0=["S10004Left_ETMg_ACL0_C20_2107131415",... 
%     "S10004Left_ETMg_ACL0_C20_2107141244",...
%     "S10004Left_ETMg_ACL0_C20_2107141324",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_C20_2107131411",...
%     "S10004Left_ETMw_ACL0_C20_2107141251",...
%     "S10004Left_ETMw_ACL0_C20_2107141314",...
%      ]; 
% 
% ap0=["S10004Left_ETMp_ACL0_C20_2107131422",...
%     "S10004Left_ETMp_ACL0_C20_2107141240",...
%     "S10004Left_ETMp_ACL0_C20_2107141320",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2107140942",...
%     "S10004Left_ETMg_ACL1_C20_2107141026",...
%     "S10004Left_ETMg_ACL1_C20_2107141341",...
%         ]; 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2107140956", ...
%      "S10004Left_ETMw_ACL1_C20_2107141022",...
%      "S10004Left_ETMw_ACL1_C20_2107141356",...
%      ]; 
%       
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2107141003",...
%     "S10004Left_ETMp_ACL1_C20_2107141015",...
%     "S10004Left_ETMp_ACL1_C20_2107141403",...
%      ]; 
%  
%  
% %% CONVENTIONAL ANALYSIS using all the staircasses at once in psignfit CONVENTIONAL ANALYSIS
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;  L0T1p=r11;       
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;  L1T1p=r11;
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00;  L0T1w=r11;     
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00;  L1T1w=r11;        
%  
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END conventional analysis starting at line 56
% 
% 
% 
% 
% 
% 
% %% analysis for ANOVA
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% %% END ANOVA analysis
% 
% 
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')
% 
%  
% %% 3way ANOVA for unbalanced design color m p
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('M', [length(mL0T0g) 1]); repmat('M', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('P', [length(mL0T0w) 1]); repmat('P', [length( mL1T0w) 1]);...
%       repmat('P', [length(mL0T1w) 1]); repmat('P', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats]  = anovan(hg,{ACL TCA CLR},'model', 'interaction','varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% %results = multcompare(stats)
% 
% % p = anovan(hg,{ACL TCA CLR},'model', 2,'varnames',{'ACL','TCA', 'CLR'}) 
% % 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% 
% 
% %% 3way ANOVA for unbalanced design color: r g b
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
%       repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats]  = anovan(hg,{ACL TCA CLR},'model', 'interaction','varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% %results = multcompare(stats)
% 
% % p = anovan(hg,{ACL TCA CLR},'model', 2,'varnames',{'ACL','TCA', 'CLR'}) 
% % 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% 
% 
% 
% 




% 
% %%210721 ANOVA analysis
% %% One way ANOVA analysis of variance analysis
% hg=[mL0T0g' mL0T0p' mL0T1p' mL0T0w' mL0T1w'  mL1T0g' mL1T0p' mL1T1p' mL1T0w' mL1T1w']
% [p,tbl,stats] = anova1(hg);
% 
% %% 2 way ANOVA
% hg=[[mL0T0g';  mL1T0g'] [mL0T0p'; mL1T0p'] [mL0T1p'; mL1T1p'] [mL0T0w';  mL1T0w'] [mL0T1w'; mL1T1w']]
% [p,tbl,stats] = anova2(hg,8);
% c = multcompare(stats)
% 
% %% 2way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('ACL0', [length(mL0T0g) 1]); repmat('ACL1', [length( mL1T0g) 1]);...
%      repmat('ACL0', [length(mL0T0p) 1]); repmat('ACL1', [length( mL1T0p) 1]);...
%      repmat('ACL0', [length(mL0T1p) 1]); repmat('ACL1', [length( mL1T1p) 1]);...
%      repmat('ACL0', [length(mL0T0w) 1]); repmat('ACL1', [length( mL1T0w) 1]);...
%      repmat('ACL0', [length(mL0T1w) 1]); repmat('ACL1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('TCA0', [length(mL0T0g) 1]); repmat('TCA0', [length( mL1T0g) 1]);...
%       repmat('TCA0', [length(mL0T0p) 1]); repmat('TCA0', [length( mL1T0p) 1]);...
%       repmat('TCA1', [length(mL0T1p) 1]); repmat('TCA1', [length( mL1T1p) 1]);...
%       repmat('TCA0', [length(mL0T0w) 1]); repmat('TCA0', [length( mL1T0w) 1]);...
%       repmat('TCA1', [length(mL0T1w) 1]); repmat('TCA1', [length( mL1T1w) 1]);...
%      ];
% 
% p = anovan(hg,{ACL TCA},'model',2,'varnames',{'ACL','TCA'}) 
%  
%  
% %% 3way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('A0', [length(mL0T0g) 1]); repmat('A1', [length( mL1T0g) 1]);...
%      repmat('A0', [length(mL0T0p) 1]); repmat('A1', [length( mL1T0p) 1]);...
%      repmat('A0', [length(mL0T1p) 1]); repmat('A1', [length( mL1T1p) 1]);...
%      repmat('A0', [length(mL0T0w) 1]); repmat('A1', [length( mL1T0w) 1]);...
%      repmat('A0', [length(mL0T1w) 1]); repmat('A1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('T0', [length(mL0T0g) 1]); repmat('T0', [length( mL1T0g) 1]);...
%       repmat('T0', [length(mL0T0p) 1]); repmat('T0', [length( mL1T0p) 1]);...
%       repmat('T1', [length(mL0T1p) 1]); repmat('T1', [length( mL1T1p) 1]);...
%       repmat('T0', [length(mL0T0w) 1]); repmat('T0', [length( mL1T0w) 1]);...
%       repmat('T1', [length(mL0T1w) 1]); repmat('T1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('G', [length(mL0T0g) 1]); repmat('G', [length( mL1T0g) 1]);...
%       repmat('P', [length(mL0T0p) 1]); repmat('P', [length( mL1T0p) 1]);...
%       repmat('P', [length(mL0T1p) 1]); repmat('P', [length( mL1T1p) 1]);...
%       repmat('W', [length(mL0T0w) 1]); repmat('W', [length( mL1T0w) 1]);...
%       repmat('W', [length(mL0T1w) 1]); repmat('W', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats]  = anovan(hg,{ACL TCA CLR},'model', 'interaction','varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% %results = multcompare(stats)
% 
% % p = anovan(hg,{ACL TCA CLR},'model', 2,'varnames',{'ACL','TCA', 'CLR'}) 
% % 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% 


% %210709 only data after correction of TCA0 glitch
% 
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2107091112",... 
%      "S10003Right_ETMg_ACL0_C20_2107131605",...
%         ]; 
% ap0=["S10003Right_ETMp_ACL0_C20_2107091118",...
%     "S10003Right_ETMp_ACL0_C20_2107131610",...
%      ];  
% aw0=["S10003Right_ETMw_ACL0_C20_2107091124",...
%     "S10003Right_ETMw_ACL0_C20_2107131602",...
%      ]; 
% 
% 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_C20_2107091157",...
%     "S10003Right_ETMg_ACL1_C20_2107131523",...
%         ]; 
%     
%     %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2107091202",...
%     "S10003Right_ETMp_ACL1_C20_2107131520",...
%      ]; 
%  
% aw1=["S10003Right_ETMw_ACL1_C20_2107091154",...
%     "S10003Right_ETMw_ACL1_C20_2107131528",...
%      ]; 
%       
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%      ]; 
%             
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')
% 
% %% One way ANOVA analysis of variance analysis
% hg=[mL0T0g' mL0T0p' mL0T1p' mL0T0w' mL0T1w'  mL1T0g' mL1T0p' mL1T1p' mL1T0w' mL1T1w']
% [p,tbl,stats] = anova1(hg);
% 
% %% 2 way ANOVA
% hg=[[mL0T0g';  mL1T0g'] [mL0T0p'; mL1T0p'] [mL0T1p'; mL1T1p'] [mL0T0w';  mL1T0w'] [mL0T1w'; mL1T1w']]
% [p,tbl,stats] = anova2(hg,8);
% c = multcompare(stats)
% 
% %% 2way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('ACL0', [length(mL0T0g) 1]); repmat('ACL1', [length( mL1T0g) 1]);...
%      repmat('ACL0', [length(mL0T0p) 1]); repmat('ACL1', [length( mL1T0p) 1]);...
%      repmat('ACL0', [length(mL0T1p) 1]); repmat('ACL1', [length( mL1T1p) 1]);...
%      repmat('ACL0', [length(mL0T0w) 1]); repmat('ACL1', [length( mL1T0w) 1]);...
%      repmat('ACL0', [length(mL0T1w) 1]); repmat('ACL1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('TCA0', [length(mL0T0g) 1]); repmat('TCA0', [length( mL1T0g) 1]);...
%       repmat('TCA0', [length(mL0T0p) 1]); repmat('TCA0', [length( mL1T0p) 1]);...
%       repmat('TCA1', [length(mL0T1p) 1]); repmat('TCA1', [length( mL1T1p) 1]);...
%       repmat('TCA0', [length(mL0T0w) 1]); repmat('TCA0', [length( mL1T0w) 1]);...
%       repmat('TCA1', [length(mL0T1w) 1]); repmat('TCA1', [length( mL1T1w) 1]);...
%      ];
% 
% p = anovan(hg,{ACL TCA},'model',2,'varnames',{'ACL','TCA'}) 
%  
%  
% %% 3way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('ACL0', [length(mL0T0g) 1]); repmat('ACL1', [length( mL1T0g) 1]);...
%      repmat('ACL0', [length(mL0T0p) 1]); repmat('ACL1', [length( mL1T0p) 1]);...
%      repmat('ACL0', [length(mL0T1p) 1]); repmat('ACL1', [length( mL1T1p) 1]);...
%      repmat('ACL0', [length(mL0T0w) 1]); repmat('ACL1', [length( mL1T0w) 1]);...
%      repmat('ACL0', [length(mL0T1w) 1]); repmat('ACL1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('TCA0', [length(mL0T0g) 1]); repmat('TCA0', [length( mL1T0g) 1]);...
%       repmat('TCA0', [length(mL0T0p) 1]); repmat('TCA0', [length( mL1T0p) 1]);...
%       repmat('TCA1', [length(mL0T1p) 1]); repmat('TCA1', [length( mL1T1p) 1]);...
%       repmat('TCA0', [length(mL0T0w) 1]); repmat('TCA0', [length( mL1T0w) 1]);...
%       repmat('TCA1', [length(mL0T1w) 1]); repmat('TCA1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('GRN', [length(mL0T0g) 1]); repmat('GRN', [length( mL1T0g) 1]);...
%       repmat('PRL', [length(mL0T0p) 1]); repmat('PRL', [length( mL1T0p) 1]);...
%       repmat('PRL', [length(mL0T1p) 1]); repmat('PRL', [length( mL1T1p) 1]);...
%       repmat('WHT', [length(mL0T0w) 1]); repmat('WHT', [length( mL1T0w) 1]);...
%       repmat('WHT', [length(mL0T1w) 1]); repmat('WHT', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats]  = anovan(hg,{ACL TCA CLR},'model', 'interaction','varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% %results = multcompare(stats)
% 
% % p = anovan(hg,{ACL TCA CLR},'model', 2,'varnames',{'ACL','TCA', 'CLR'}) 
% % 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])





% %210707 add anova analysis
% 
% %% MSB ACL0
% ag0=["S10004Left_ETMg_ACL0_2106221433",...  
%     "S10004Left_ETMg_ACL0_C20_2106231336",... %tired
%     "S10004Left_ETMg_ACL0_C20_2106231406",... %fresh
%     "S10004Left_ETMg_ACL0_C20_2106281025",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_2106221449", ...
%     "S10004Left_ETMw_ACL0_C20_2106231324",...
%     "S10004Left_ETMw_ACL0_C20_2106281032",...
%     "S10004Left_ETMw_ACL0_C20_2106301045",...
%      ]; 
% 
% 
% ap0=["S10004Left_ETMp_ACL0_2106221441", ...
%     "S10004Left_ETMp_ACL0_C20_2106231331",...
%     "S10004Left_ETMp_ACL0_C20_2106281039",...
%     "S10004Left_ETMp_ACL0_C20_2106301052",...
%      ]; 
% %% MSB ACL1
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2106211622",...
%     "S10004Left_ETMg_ACL1_C20_2106241437",...
%     "S10004Left_ETMg_ACL1_C20_2106281103",...
%     "S10004Left_ETMg_ACL1_C20_2106301324",...
%         ]; 
% 
% 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2106211635", ...
%     "S10004Left_ETMw_ACL1_C20_2106241451",...
%     "S10004Left_ETMw_ACL1_C20_2106281110",...
%     "S10004Left_ETMw_ACL1_C20_2106301417",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2106211628",...
%     "S10004Left_ETMp_ACL1_C20_2106241444",...
%     "S10004Left_ETMp_ACL1_C20_2106281058",...
%     "S10004Left_ETMp_ACL1_C20_2106301411",...
%      ]; 
%       
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2106251445",... 
%     "S10003Right_ETMg_ACL0_C20_2106291549",...
%     "S10003Right_ETMg_ACL0_C20_2107091112",... %TCA correct
%         ]; 
% 
% aw0=["S10003Right_ETMw_ACL0_C20_2106251450",...
%     "S10003Right_ETMw_ACL0_C20_2106291612",...
%     "S10003Right_ETMw_ACL0_C20_2107091124",...
%      ]; 
% 
% ap0=["S10003Right_ETMp_ACL0_C20_2106251442",...
%     "S10003Right_ETMp_ACL0_C20_2106291606",...
%     "S10003Right_ETMp_ACL0_C20_2107091118",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_2106181318_20contrast",...
%     "S10003Right_ETMg_ACL1_C20_2106251333",...
%     "S10003Right_ETMg_ACL1_C20_2106291637",...
%     "S10003Right_ETMg_ACL1_C20_2107091157",...
%         ]; 
% 
% 
% 
% aw1=["S10003Right_ETMw_ACL1_C20_2106181330", ...
%     "S10003Right_ETMw_ACL1_C20_2106251344",...
%     "S10003Right_ETMw_ACL1_C20_2106291628",...
%     "S10003Right_ETMw_ACL1_C20_2107091154",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2106181324",...
% 	"S10003Right_ETMp_ACL1_C20_2106251338",...
%     "S10003Right_ETMp_ACL1_C20_2106291634",...
%     "S10003Right_ETMp_ACL1_C20_2107091202",...
%      ]; 
%  
%  
%  %% NHI 
% ag0=["S10007Right_ETMg_ACL0_C20_2107081253",... 
%         ]; 
% 
% aw0=["S10007Right_ETMw_ACL0_C20_2107081325",...
%      ]; 
% 
% ap0=["S10007Right_ETMp_ACL0_C20_2107081336",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10007Right_ETMg_ACL1_C20_2107081522",...
%         ]; 
% 
% 
% 
% aw1=["S10007Right_ETMw_ACL1_C20_2107081517", ...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10007Right_ETMp_ACL1_C20_2107081509",...
%      ]; 
%             
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; mL0T0g=r10;      
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; mL1T0g=r10; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11; mL0T0p=r10(y0==0);   mL0T1p=r10(y0==1);    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11; mL1T0p=r10(y0==0);   mL1T1p=r10(y0==1);
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;  mL0T0w=r10(y0==0); mL0T1w=r10(y0==1);       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5;  [r00 r11 r10]=psf_ETM3(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;  mL1T0w=r10(y0==0); mL1T1w=r10(y0==1);      
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')
% 
% %% One way ANOVA analysis of variance analysis
% hg=[mL0T0g' mL0T0p' mL0T1p' mL0T0w' mL0T1w'  mL1T0g' mL1T0p' mL1T1p' mL1T0w' mL1T1w']
% [p,tbl,stats] = anova1(hg);
% 
% %% 2 way ANOVA
% hg=[[mL0T0g';  mL1T0g'] [mL0T0p'; mL1T0p'] [mL0T1p'; mL1T1p'] [mL0T0w';  mL1T0w'] [mL0T1w'; mL1T1w']]
% [p,tbl,stats] = anova2(hg,8);
% c = multcompare(stats)
% 
% %% 2way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('ACL0', [length(mL0T0g) 1]); repmat('ACL1', [length( mL1T0g) 1]);...
%      repmat('ACL0', [length(mL0T0p) 1]); repmat('ACL1', [length( mL1T0p) 1]);...
%      repmat('ACL0', [length(mL0T1p) 1]); repmat('ACL1', [length( mL1T1p) 1]);...
%      repmat('ACL0', [length(mL0T0w) 1]); repmat('ACL1', [length( mL1T0w) 1]);...
%      repmat('ACL0', [length(mL0T1w) 1]); repmat('ACL1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('TCA0', [length(mL0T0g) 1]); repmat('TCA0', [length( mL1T0g) 1]);...
%       repmat('TCA0', [length(mL0T0p) 1]); repmat('TCA0', [length( mL1T0p) 1]);...
%       repmat('TCA1', [length(mL0T1p) 1]); repmat('TCA1', [length( mL1T1p) 1]);...
%       repmat('TCA0', [length(mL0T0w) 1]); repmat('TCA0', [length( mL1T0w) 1]);...
%       repmat('TCA1', [length(mL0T1w) 1]); repmat('TCA1', [length( mL1T1w) 1]);...
%      ];
% 
% p = anovan(hg,{ACL TCA},'model',2,'varnames',{'ACL','TCA'}) 
%  
%  
% %% 3way ANOVA for unbalanced design
% hg=[mL0T0g';  mL1T0g'; mL0T0p'; mL1T0p'; mL0T1p'; mL1T1p'; mL0T0w';  mL1T0w'; mL0T1w'; mL1T1w']
% ACL=[repmat('ACL0', [length(mL0T0g) 1]); repmat('ACL1', [length( mL1T0g) 1]);...
%      repmat('ACL0', [length(mL0T0p) 1]); repmat('ACL1', [length( mL1T0p) 1]);...
%      repmat('ACL0', [length(mL0T1p) 1]); repmat('ACL1', [length( mL1T1p) 1]);...
%      repmat('ACL0', [length(mL0T0w) 1]); repmat('ACL1', [length( mL1T0w) 1]);...
%      repmat('ACL0', [length(mL0T1w) 1]); repmat('ACL1', [length( mL1T1w) 1]);...
%      ];
%  
%  TCA=[repmat('TCA0', [length(mL0T0g) 1]); repmat('TCA0', [length( mL1T0g) 1]);...
%       repmat('TCA0', [length(mL0T0p) 1]); repmat('TCA0', [length( mL1T0p) 1]);...
%       repmat('TCA1', [length(mL0T1p) 1]); repmat('TCA1', [length( mL1T1p) 1]);...
%       repmat('TCA0', [length(mL0T0w) 1]); repmat('TCA0', [length( mL1T0w) 1]);...
%       repmat('TCA1', [length(mL0T1w) 1]); repmat('TCA1', [length( mL1T1w) 1]);...
%      ];
%  
%  CLR=[repmat('GRN', [length(mL0T0g) 1]); repmat('GRN', [length( mL1T0g) 1]);...
%       repmat('PRL', [length(mL0T0p) 1]); repmat('PRL', [length( mL1T0p) 1]);...
%       repmat('PRL', [length(mL0T1p) 1]); repmat('PRL', [length( mL1T1p) 1]);...
%       repmat('WHT', [length(mL0T0w) 1]); repmat('WHT', [length( mL1T0w) 1]);...
%       repmat('WHT', [length(mL0T1w) 1]); repmat('WHT', [length( mL1T1w) 1]);...
%      ];
% 
% [p,tbl,stats]  = anovan(hg,{ACL TCA CLR},'model', 'interaction','varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])
% %results = multcompare(stats)
% 
% % p = anovan(hg,{ACL TCA CLR},'model', 2,'varnames',{'ACL','TCA', 'CLR'}) 
% % 
% [p,tbl,stats] = anovan(hg,{ACL TCA CLR},'varnames',{'ACL','TCA', 'CLR'}) 
% results = multcompare(stats,'Dimension',[1 2 3])




% %210705 using individual staicases to calculate mean and std
% 
% %% MSB ACL0
% ag0=["S10004Left_ETMg_ACL0_2106221433",...  
%     "S10004Left_ETMg_ACL0_C20_2106231336",... %tired
%     "S10004Left_ETMg_ACL0_C20_2106231406",... %fresh
%     "S10004Left_ETMg_ACL0_C20_2106281025",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_2106221449", ...
%     "S10004Left_ETMw_ACL0_C20_2106231324",...
%     "S10004Left_ETMw_ACL0_C20_2106281032",...
%     "S10004Left_ETMw_ACL0_C20_2106301045",...
%      ]; 
% 
% 
% ap0=["S10004Left_ETMp_ACL0_2106221441", ...
%     "S10004Left_ETMp_ACL0_C20_2106231331",...
%     "S10004Left_ETMp_ACL0_C20_2106281039",...
%     "S10004Left_ETMp_ACL0_C20_2106301052",...
%      ]; 
% %% MSB ACL1
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2106211622",...
%     "S10004Left_ETMg_ACL1_C20_2106241437",...
%     "S10004Left_ETMg_ACL1_C20_2106281103",...
%     "S10004Left_ETMg_ACL1_C20_2106301324",...
%         ]; 
% 
% 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2106211635", ...
%     "S10004Left_ETMw_ACL1_C20_2106241451",...
%     "S10004Left_ETMw_ACL1_C20_2106281110",...
%     "S10004Left_ETMw_ACL1_C20_2106301417",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2106211628",...
%     "S10004Left_ETMp_ACL1_C20_2106241444",...
%     "S10004Left_ETMp_ACL1_C20_2106281058",...
%     "S10004Left_ETMp_ACL1_C20_2106301411",...
%      ]; 
%       
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2106251445",... 
%     "S10003Right_ETMg_ACL0_C20_2106291549",...
%         ]; 
% 
% aw0=["S10003Right_ETMw_ACL0_C20_2106251450",...
%     "S10003Right_ETMw_ACL0_C20_2106291612",...
%      ]; 
% 
% ap0=["S10003Right_ETMp_ACL0_C20_2106251442",...
%     "S10003Right_ETMp_ACL0_C20_2106291606",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_2106181318_20contrast",...
%     "S10003Right_ETMg_ACL1_C20_2106251333",...
%     "S10003Right_ETMg_ACL1_C20_2106291637",...
%         ]; 
% 
% 
% 
% aw1=["S10003Right_ETMw_ACL1_C20_2106181330", ...
%     "S10003Right_ETMw_ACL1_C20_2106251344",...
%     "S10003Right_ETMw_ACL1_C20_2106291628",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2106181324",...
% 	"S10003Right_ETMp_ACL1_C20_2106251338",...
%     "S10003Right_ETMp_ACL1_C20_2106291634",...
%      ]; 
%             
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L1T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L0T0p=r00;   L0T1p=r11;    
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L1T0p=r00;   L1T1p=r11;
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;      
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM2(y0, y1, w2, d1); disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;       
%   
%  
% cls; %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=5; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=5; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')




% %210705 centerlizing the analysis ag0 ag1 aw0 aw1 ap0 ap1
% 
% %% MSB ACL0
% ag0=["S10004Left_ETMg_ACL0_2106221433",...  
%     "S10004Left_ETMg_ACL0_C20_2106231336",... %tired
%     "S10004Left_ETMg_ACL0_C20_2106231406",... %fresh
%     "S10004Left_ETMg_ACL0_C20_2106281025",...
%         ]; 
% 
% aw0=["S10004Left_ETMw_ACL0_2106221449", ...
%     "S10004Left_ETMw_ACL0_C20_2106231324",...
%     "S10004Left_ETMw_ACL0_C20_2106281032",...
%     "S10004Left_ETMw_ACL0_C20_2106301045",...
%      ]; 
% 
% 
% ap0=["S10004Left_ETMp_ACL0_2106221441", ...
%     "S10004Left_ETMp_ACL0_C20_2106231331",...
%     "S10004Left_ETMp_ACL0_C20_2106281039",...
%     "S10004Left_ETMp_ACL0_C20_2106301052",...
%      ]; 
% %% MSB ACL1
% 
% %%20%contrast mark 210621
% ag1=["S10004Left_ETMg_ACL1_C20_2106211622",...
%     "S10004Left_ETMg_ACL1_C20_2106241437",...
%     "S10004Left_ETMg_ACL1_C20_2106281103",...
%     "S10004Left_ETMg_ACL1_C20_2106301324",...
%         ]; 
% 
% 
% 
% aw1=["S10004Left_ETMw_ACL1_C20_2106211635", ...
%     "S10004Left_ETMw_ACL1_C20_2106241451",...
%     "S10004Left_ETMw_ACL1_C20_2106281110",...
%     "S10004Left_ETMw_ACL1_C20_2106301417",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10004Left_ETMp_ACL1_C20_2106211628",...
%     "S10004Left_ETMp_ACL1_C20_2106241444",...
%     "S10004Left_ETMp_ACL1_C20_2106281058",...
%     "S10004Left_ETMp_ACL1_C20_2106301411",...
%      ]; 
%       
% %% AJR 
% ag0=["S10003Right_ETMg_ACL0_C20_2106251445",... 
%     "S10003Right_ETMg_ACL0_C20_2106291549",...
%         ]; 
% 
% aw0=["S10003Right_ETMw_ACL0_C20_2106251450",...
%     "S10003Right_ETMw_ACL0_C20_2106291612",...
%      ]; 
% 
% ap0=["S10003Right_ETMp_ACL0_C20_2106251442",...
%     "S10003Right_ETMp_ACL0_C20_2106291606",...
%      ]; 
% 
% %%20%contrast mark 210621
% ag1=["S10003Right_ETMg_ACL1_2106181318_20contrast",...
%     "S10003Right_ETMg_ACL1_C20_2106251333",...
%     "S10003Right_ETMg_ACL1_C20_2106291637",...
%         ]; 
% 
% 
% 
% aw1=["S10003Right_ETMw_ACL1_C20_2106181330", ...
%     "S10003Right_ETMw_ACL1_C20_2106251344",...
%     "S10003Right_ETMw_ACL1_C20_2106291628",...
%      ]; 
%       
% 
% %20%contrast mark 210621
% ap1=["S10003Right_ETMp_ACL1_C20_2106181324",...
% 	"S10003Right_ETMp_ACL1_C20_2106251338",...
%     "S10003Right_ETMp_ACL1_C20_2106291634",...
%      ]; 
%             
% 
% [w2 y1 y0 STKv]=cmbn0(ag0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ag1); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; 
% 
% [w2 y1 y0 STKv]=cmbn0(ap0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(ap1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00; 
%             
% [w2 y1 y0 STKv]=cmbn0(aw0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
% [w2 y1 y0 STKv]=cmbn0(aw1); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); disp(r00); disp(r11); L0T0g=r00;       
%   
%  
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')



% %210628 moved t psignfit with LogMAR
% 
% %% MSB ACL0
% a0=["S10004Left_ETMg_ACL0_2106221433",...  
%     "S10004Left_ETMg_ACL0_C20_2106231336",... %tired
%     "S10004Left_ETMg_ACL0_C20_2106231406",... %fresh
%     "S10004Left_ETMg_ACL0_C20_2106281025",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% %     ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% 
% 
% a0=["S10004Left_ETMw_ACL0_2106221449", ...
%     "S10004Left_ETMw_ACL0_C20_2106231324",...
%     "S10004Left_ETMw_ACL0_C20_2106281032",...
%     "S10004Left_ETMw_ACL0_C20_2106301045",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% %     ]; [w2 y1 y0]=cmbn(a0);  d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); 
% 
% 
% a0=["S10004Left_ETMp_ACL0_2106221441", ...
%     "S10004Left_ETMp_ACL0_C20_2106231331",...
%     "S10004Left_ETMp_ACL0_C20_2106281039",...
%     "S10004Left_ETMp_ACL0_C20_2106301052",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% %% MSB ACL1
% 
% %%20%contrast mark 210621
% a0=["S10004Left_ETMg_ACL1_C20_2106211622",...
%     "S10004Left_ETMg_ACL1_C20_2106241437",...
%     "S10004Left_ETMg_ACL1_C20_2106281103",...
%     "S10004Left_ETMg_ACL1_C20_2106301324",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% 
% 
% a0=["S10004Left_ETMw_ACL1_C20_2106211635", ...
%     "S10004Left_ETMw_ACL1_C20_2106241451",...
%     "S10004Left_ETMw_ACL1_C20_2106281110",...
%     "S10004Left_ETMw_ACL1_C20_2106301417",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
%       
% 
% %20%contrast mark 210621
% a0=["S10004Left_ETMp_ACL1_C20_2106211628",...
%     "S10004Left_ETMp_ACL1_C20_2106241444",...
%     "S10004Left_ETMp_ACL1_C20_2106281058",...
%     "S10004Left_ETMp_ACL1_C20_2106301411",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
%       
%       
% %% AJR 
% a0=["S10003Right_ETMg_ACL0_C20_2106251445",... 
%     "S10003Right_ETMg_ACL0_C20_2106291549",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% 
% a0=["S10003Right_ETMw_ACL0_C20_2106251450",...
%     "S10003Right_ETMw_ACL0_C20_2106291612",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% 
% a0=["S10003Right_ETMp_ACL0_C20_2106251442",...
%     "S10003Right_ETMp_ACL0_C20_2106291606",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% 
% %%20%contrast mark 210621
% a0=["S10003Right_ETMg_ACL1_2106181318_20contrast",...
%     "S10003Right_ETMg_ACL1_C20_2106251333",...
%     "S10003Right_ETMg_ACL1_C20_2106291637",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% 
% 
% a0=["S10003Right_ETMw_ACL1_C20_2106181330", ...
%     "S10003Right_ETMw_ACL1_C20_2106251344",...
%     "S10003Right_ETMw_ACL1_C20_2106291628",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
%       
% 
% %20%contrast mark 210621
% a0=["S10003Right_ETMp_ACL1_C20_2106181324",...
% 	"S10003Right_ETMp_ACL1_C20_2106251338",...
%     "S10003Right_ETMp_ACL1_C20_2106291634",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
%             
% 
%       
%             
% 
% 
% %% plot histogram with errorbars
% r=1, c=4; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=3; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=4; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=2; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')


% %210622 started 20 contrast
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% %% AJR ACL0
% a0=["S10003_ETMgrn_RightACL0_2104301127",...  %not sure if trombone position was correct
%      "S10003Right_ETMg_ACL0_2106111432",...
%      "S10003Right_ETMg_ACL0_2106111602",...   
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10003_ETMw_RightACL0_2104301141",...
%      "S10003Right_ETMw_ACL0_2106111430",...
%      "S10003Right_ETMw_ACL0_2106111611",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% 
% % a0=["S10003_ETMprl_RightACL0_2104301134", ...
% %     "S10003Right_ETMp_ACL0_2106111607",...
% %     "S10003Right_ETMp_ACL0_2106111424",...
% a0=["S10003_ETMprl_RightACL0_2104301134", ...
%     "S10003Right_ETMp_ACL0_2106111607",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% 
% %% AJR ACL1
% 
% %S10003Right_ETMg_ACL1_2106181311_100contrast
% %S10003Right_ETMg_ACL1_2106181315_10contrast
% %S10003Right_ETMg_ACL1_2106181318_20contrast
% 
% a0=["S10003_ETMg_RightACL1_2104301254",...  %%AJR ACL1 green 
%     "S10003_ETMg_RightACL1_2105211143",... %
%     "S10003Right_ETMg_ACL1_2106111506",...
%     "S10003Right_ETMg_ACL1_2106111637",...
%      ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
%       
%       
% % %% AJR ACL1
% % a0=["S10003_ETMg_RightACL1_2104301254",...  %%AJR ACL1 green 
% %     "S10003Right_ETMg_ACL1_2106111506",...
% %     "S10003Right_ETMg_ACL1_2106111637",...
% %      ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0g=r00; 
% 
% %S10003Right_ETMw_ACL1_C20_2106181330
% a0=["S10003_ETMw_RightACL1_2104301302", ...
%     "S10003_ETMw_RightACL1_2105211152",...
%     "S10003Right_ETMw_ACL1_2106111459",...
%     "S10003Right_ETMw_ACL1_2106111629",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
% 
% % a0=["S10003_ETMw_RightACL1_2104301302", ...
% %     "S10003Right_ETMw_ACL1_2106111459",...
% %     "S10003Right_ETMw_ACL1_2106111629",...
% %      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
% %S10003Right_ETMp_ACL1_C20_2106181324
% a0=["S10003_ETMp_RightACL1_2104301309", ...
%     "S10003_ETMp_RightACL1_2105211147",...
% a0=["S10003Right_ETMp_ACL1_2106111503",...
%     "S10003Right_ETMp_ACL1_2106111634",...
%      ]; [w2 y1 y0 STKv]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
% 
% 
% % a0=["S10003_ETMp_RightACL1_2104301309", ...
% %     "S10003Right_ETMp_ACL1_2106111503",...
% %     "S10003Right_ETMp_ACL1_2106111634",...
% %      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
% 
% 
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% %% MSB ACL0
% a0=["S10004Left_ETMg_ACL0_2106221433",...  
%     "S10004Left_ETMg_ACL0_C20_2106231336",... %tired
%     "S10004Left_ETMg_ACL0_C20_2106231406",... %fresh
%     "S10004Left_ETMg_ACL0_C20_2106281025",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM1(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% %     ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% 
% 
% a0=["S10004Left_ETMw_ACL0_2106221449", ...
%     "S10004Left_ETMw_ACL0_C20_2106231324",...
%     "S10004Left_ETMw_ACL0_C20_2106281032",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% %     ]; [w2 y1 y0]=cmbn(a0);  d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); 
% 
% 
% a0=["S10004Left_ETMp_ACL0_2106221441", ...
%     "S10004Left_ETMp_ACL0_C20_2106231331",...
%     "S10004Left_ETMp_ACL0_C20_2106281039",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% %% MSB ACL1
% 
% %%20%contrast mark 210621
% a0=["S10004Left_ETMg_ACL1_C20_2106211622",...
%     "S10004Left_ETMg_ACL1_C20_2106241437",...
%     "S10004Left_ETMg_ACL1_C20_2106281103",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% 
% 
% a0=["S10004Left_ETMw_ACL1_C20_2106211635", ...
%     "S10004Left_ETMw_ACL1_C20_2106241451",...
%     "S10004Left_ETMw_ACL1_C20_2106281110",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
%       
% 
% %20%contrast mark 210621
% a0=["S10004Left_ETMp_ACL1_C20_2106211628",...
%     "S10004Left_ETMp_ACL1_C20_2106241444",...
%     "S10004Left_ETMp_ACL1_C20_2106281058",...
%      ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
%             
% %NHI ACL0
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% a0=["S10007_ETMg_RightACL0_2105271235.mat",...
%     "S10007Right_ETMg_ACL0_2106161244.mat",...
%     ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10007_ETMp_RightACL0_2105271243.mat",...
%     "S10007Right_ETMp_ACL0_2106161306.mat",...
%         ]; [w2 y1 y0 STKv]=cmbn0(a0); d1=5; [r00 r11]=psf_ETM0(y0, y1, w2, d1); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% 
% 
% 
% a0=["S10007_ETMw_RightACL0_2105271225.mat",...
%     "S10007Right_ETMw_ACL0_2106161257.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% 
% 
% %NHI ACL1
% a0=["S10007_ETMg_RightACL1_2105271408.mat",...
%     "S10007Right_ETMg_ACL1_2106161346.mat",
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% a0=["S10007_ETMp_RightACL1_2105271401.mat",...
%     "S10007Right_ETMp_ACL1_2106161355.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11; 
% 
% 
% 
% a0=["S10007_ETMw_RightACL1_2105271416.mat",...
%     "S10007Right_ETMw_ACL1_2106161337.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11; 
% 
% 
% %JOL ACL0
% 
% STK00=[4.0000    4.6000    5.2000    6.0000    7.0000    8.0000    9.2000   10.6000   12.2000   14.0000   16.0000   18.4000   21.2000]
% a0=["S10005Right_ETMg_ACL0_2106081402.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10005Right_ETMp_ACL0_2106081358.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11; 
% 
% 
% a0=["S10005Right_ETMw_ACL0_2106081351.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11; 
% 
% 
% %JOL ACL1
% a0=["S10005Right_ETMg_ACL1_2106081446.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% a0=["S10005Right_ETMp_ACL1_2106081452.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11; 
% 
% a0=["S10005Right_ETMw_ACL1_2106081458.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11; 
% 
% 
% %% plot histogram with errorbars
% r=1, c=3; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=3; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=3; c=3; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=1; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% ylabel('MAR Acuity')





% %210523 calculate data/figure for ETM/VA data
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% %% AJR ACL0
% a0=["S10003_ETMgrn_RightACL0_2104301127",...  %not sure if trombone position was correct
%      "S10003Right_ETMg_ACL0_2106111432",...
%      "S10003Right_ETMg_ACL0_2106111602",...   
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10003_ETMw_RightACL0_2104301141",...
%      "S10003Right_ETMw_ACL0_2106111430",...
%      "S10003Right_ETMw_ACL0_2106111611",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% 
% % a0=["S10003_ETMprl_RightACL0_2104301134", ...
% %     "S10003Right_ETMp_ACL0_2106111607",...
% %     "S10003Right_ETMp_ACL0_2106111424",...
% a0=["S10003_ETMprl_RightACL0_2104301134", ...
%     "S10003Right_ETMp_ACL0_2106111607",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% 
% %% AJR ACL1
% 
% %S10003Right_ETMg_ACL1_2106181311_100contrast
% %S10003Right_ETMg_ACL1_2106181315_10contrast
% %S10003Right_ETMg_ACL1_2106181318_20contrast
% 
% a0=["S10003_ETMg_RightACL1_2104301254",...  %%AJR ACL1 green 
%     "S10003_ETMg_RightACL1_2105211143",... %
%     "S10003Right_ETMg_ACL1_2106111506",...
%     "S10003Right_ETMg_ACL1_2106111637",...
%      ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
%       
%       
% % %% AJR ACL1
% % a0=["S10003_ETMg_RightACL1_2104301254",...  %%AJR ACL1 green 
% %     "S10003Right_ETMg_ACL1_2106111506",...
% %     "S10003Right_ETMg_ACL1_2106111637",...
% %      ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0g=r00; 
% 
% %S10003Right_ETMw_ACL1_C20_2106181330
% a0=["S10003_ETMw_RightACL1_2104301302", ...
%     "S10003_ETMw_RightACL1_2105211152",...
%     "S10003Right_ETMw_ACL1_2106111459",...
%     "S10003Right_ETMw_ACL1_2106111629",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
% 
% % a0=["S10003_ETMw_RightACL1_2104301302", ...
% %     "S10003Right_ETMw_ACL1_2106111459",...
% %     "S10003Right_ETMw_ACL1_2106111629",...
% %      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
% %S10003Right_ETMp_ACL1_C20_2106181324
% a0=["S10003_ETMp_RightACL1_2104301309", ...
%     "S10003_ETMp_RightACL1_2105211147",...
%     "S10003Right_ETMp_ACL1_2106111503",...
%     "S10003Right_ETMp_ACL1_2106111634",...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
% 
% 
% % a0=["S10003_ETMp_RightACL1_2104301309", ...
% %     "S10003Right_ETMp_ACL1_2106111503",...
% %     "S10003Right_ETMp_ACL1_2106111634",...
% %      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% %       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
% 
% 
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% %% MSB ACL0
% a0=["S10004_ETMg_LeftACL0_2105051530",...  
%     "S10004_ETMg_LeftACL0_2105061420",...
%     "S10004_ETMg_LeftACL0_2105201337",...
%     "S10004Left_ETMg_ACL0_2106101245"...
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% %     ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); %%step4 psignfit combined
% 
% a0=["S10004_ETMw_LeftACL0_2105051526", ...
%     "S10004_ETMw_LeftACL0_2105061416",...
%     "S10004_ETMw_LeftACL0_2105201349",...
%     "S10004Left_ETMw_ACL0_2106101241"...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% %     ]; [w2 y1 y0]=cmbn(a0);  d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK00); 
% 
% a0=["S10004_ETMp_LeftACL0_2105051536", ...
%     "S10004_ETMp_LeftACL0_2105061409",...
%     "S10004_ETMp_LeftACL0_2105201343",...
%     "S10004Left_ETMp_ACL0_2106101250"...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% %% MSB ACL1
% a0=["S10004_ETMgrn_LeftACL1_2104141355",...  
%     "S10004_ETMg_LeftACL1_2105041529",... 
%     "S10004_ETMg_LeftACL1_2105051549",...
%     "S10004_ETMg_LeftACL1_2105241345",...
% %%20%contrast mark 210621
% a0=["S10004Left_ETMg_ACL1_2106211622",...  
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% 
% a0=["S10004_ETMwht_LeftACL1_2104141351", ...
%     "S10004_ETMw_LeftACL1_2105041515",... 
%     "S10004_ETMw_LeftACL1_2105051601",...
%     "S10004_ETMw_LeftACL1_2105241336",...
% %20%contrast 210621
% 
% a0=["S10004Left_ETMw_ACL1_2106211635", ...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11;
%       
% a0=["S10004_ETMprpl_LeftACL1_2104141344", ...
%     "S10004_ETMp_LeftACL1_2105041523",... 
%     "S10004_ETMp_LeftACL1_2105051555",...
%     "S10004_ETMp_LeftACL1_2105241342",...
% %20%contrast mark 210621
% a0=["S10004Left_ETMp_ACL1_2106211628", ...
%      ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11;
%             
% %NHI ACL0
% STK00=[1.4000    1.6000    1.8000    2.0000    2.2000    2.6000    3.0000    3.4000    4.0000    4.6000    5.2000    6.0000    7.0000];
% a0=["S10007_ETMg_RightACL0_2105271235.mat",...
%     "S10007Right_ETMg_ACL0_2106161244.mat",...
%     ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10007_ETMp_RightACL0_2105271243.mat",...
%     "S10007Right_ETMp_ACL0_2106161306.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11;
% 
% 
% 
% a0=["S10007_ETMw_RightACL0_2105271225.mat",...
%     "S10007Right_ETMw_ACL0_2106161257.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11;
% 
% 
% %NHI ACL1
% a0=["S10007_ETMg_RightACL1_2105271408.mat",...
%     "S10007Right_ETMg_ACL1_2106161346.mat",
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% a0=["S10007_ETMp_RightACL1_2105271401.mat",...
%     "S10007Right_ETMp_ACL1_2106161355.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11; 
% 
% 
% 
% a0=["S10007_ETMw_RightACL1_2105271416.mat",...
%     "S10007Right_ETMw_ACL1_2106161337.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11; 
% 
% 
% %JOL ACL0
% 
% STK00=[4.0000    4.6000    5.2000    6.0000    7.0000    8.0000    9.2000   10.6000   12.2000   14.0000   16.0000   18.4000   21.2000]
% a0=["S10005Right_ETMg_ACL0_2106081402.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0g=r00; 
% 
% a0=["S10005Right_ETMp_ACL0_2106081358.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0p=r00; L0T1p=r11; 
% 
% 
% a0=["S10005Right_ETMw_ACL0_2106081351.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L0T0w=r00; L0T1w=r11; 
% 
% 
% %JOL ACL1
% a0=["S10005Right_ETMg_ACL1_2106081446.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); y0=zeros(size(y0)); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0g=r00; 
% 
% a0=["S10005Right_ETMp_ACL1_2106081452.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0p=r00; L1T1p=r11; 
% 
% a0=["S10005Right_ETMw_ACL1_2106081458.mat",...
%         ]; [w2 y1 y0]=cmbn(a0); d1=5; [r00 r11]=psf_ETM(y0, y1, w2, d1, STK00); %%step4 psignfit combined
%       disp(r00); disp(r11); L1T0w=r00; L1T1w=r11; 
% 
% 
% %% plot histogram with errorbars
% r=1, c=3; y =[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];
% r=4; c=2; yL=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)];%low
% r=4; c=3; yH=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %high    
% r=1; c=1; yC=[L0T0g(r,c) L0T0p(r,c) L0T1p(r,c) L0T0w(r,c) L0T1w(r,c) 0 L1T0g(r,c) L1T0p(r,c) L1T1p(r,c) L1T0w(r,c)  L1T1w(r,c)]; %count
% x=[1:length(y)];
% X = categorical({'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% X = reordercats(X,{'A0T0g', 'A0T0p', 'A0T1p', 'A0T0w','A0T1w', '0ACL1', 'A1T0g', 'A1T0p', 'A1T1p', 'A1T0w',  'A1T1w'});
% %Y = [10 21 33 52];
% 
% b=bar(X, y);
% %% setup bar colors
% b.FaceColor = 'flat';
% c=[0 1 0]; b.CData(1,:) = c./2; b.CData(7,:) = c;
% % c=[1 0 1]; b.CData(2,:) = c./2; b.CData(3,:) = c./2; b.CData(8,:) = c; b.CData(9,:) = c; 
% c=[1 0 1]; b.CData(2,:) = 0.25.*c; b.CData(3,:) = 0.5.*c; b.CData(8,:) = 0.75.*c; b.CData(9,:) = c; 
% c=[1 1 1]; b.CData(4,:) = 0.25.*c; b.CData(5,:) = 0.5.*c; b.CData(10,:) = 0.75.*c; b.CData(11,:) = c; 
% 
% 
% 
% %% set up number of trials at top of bar
% xtips1 = b(1).XEndPoints;
% ytips1 = b(1).YEndPoints;
% labels1 = string(yC);
% text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
%     'VerticalAlignment','bottom');
% 
% hold on
% 
% er = errorbar(x, y, y-yL, yH-y);    
% er.Color = [0 0 0];                            
% er.LineStyle = 'none'; 
% 
% hold off
% 
% 
% 
% 
% 
% 
% 
% %                    d1=5; [r00 r11]=psfa(y0, y1, w2, d1, STK); %%step4 psignfit combined
%                  %d1=5; y0=zeros(size(y0)); [r00 r11]=psfa(y0, y1, w2, d1, STK); %step4 psignfit for green background