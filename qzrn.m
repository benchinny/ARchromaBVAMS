clr
rv=[0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1];
cv=[1 5 10 15 20 25 30];
p0=100000; 
r0=rv./12;
c0=12.*cv;

for r=1:length(r0)
    for c=1:length(c0)

[m0 m1 i2]=mrtg(p0, r0(r), c0(c)); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
d=100;
rc0(r,c)=round(d.*m0)./d;
rc1(r,c)=round(d.*m1)./d;
rc2(r,c)=round(d.*i2)./d;

    end
end

rc0=[cv; rc0]; rc0=[[0 rv]' rc0];
rc1=[cv; rc1]; rc1=[[0 rv]' rc1];
rc2=[cv; rc2]; rc2=[[0 rv]' rc2];

writematrix(rc0, 'mrtg1.xls')
writematrix(rc1, 'mrtg1.xls', 'Sheet', 2, 'WriteMode', 'append')
writematrix(rc2, 'mrtg1.xls', 'Sheet', 2, 'WriteMode', 'append')

clear all
%% calculate loan repayments 201121

clr
p0=200000; 
i0=0.03./12;
n0=12.*30;
 %'m0=843.21 m1=303554.90 i2=103554.90'
 
 p0=200000; 
i0=0.03./12;
n0=12.*25;
 %'m0=948.42 m1=284526.79 i2=84526.79'
 
  p0=200000; 
i0=0.03./12;
n0=12.*20;
 %'m0=1109.20 m1=266206.85 i2=66206.85'
 
 p0=200000; 
i0=0.03./12;
n0=12.*15;
 %'m0=1381.16 m1=248609.39 i2=48609.39'
 
p0=200000; 
i0=0.03./12;
n0=12.*10;
%'m0=1931.21 m1=231745.79 i2=31745.79'

p0=200000; 
i0=0.025./12;
n0=12.*10;
%'m0=1885.40 m1=226247.76 i2=26247.76'

p0=200000; 
i0=0.02./12;
n0=12.*10;
%'m0=1840.27 m1=220832.29 i2=20832.29'

p0=200000; 
i0=0.02./12;
n0=12.*20;
%'m0=1011.77 m1=242824.00 i2=42824.00'

p0=200000; 
i0=0.02./12;
n0=12.*30;
%'m0=739.24 m1=266126.02 i2=66126.02'

p0=61188; 
i0=0.00904./12;
n0=12.*30;
% 'm0=194.12 m1=69882.57 i2=8694.57'

p0=122379; 
i0=0.03805./12;
n0=12.*20;
%     'm0=729.08 m1=174978.84 i2=52599.84'

p0=61188; 
i0=0.05./12;
n0=12.*30;
%  'm0=328.47 m1=118249.35 i2=57061.35'

p0=185567; 
i0=0.0374./12;
n0=12.*20;
% 'm0=1099.24 m1=263817.50 i2=78250.50'

p0=183567; 
i0=0.035./12;
n0=12.*15;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%'m0=1312.29 m1=236211.92 i2=52644.92'


%% talk with Keren 210207
p0=183567; 
i0=0.0276./12;
n0=12.*15;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%'m0=1250.10 m1=225017.57 i2=41450.57'

p0=183567; 
i0=0.0309./12;
n0=12.*20;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%   'm0=1026.35 m1=246323.61 i2=62756.61'

p0=183567; 
i0=0.0304./12;
n0=12.*20-3;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%    'm0=1031.14 m1=244380.89 i2=60813.89'



p0=183567; 
i0=0.0274./12;
n0=12.*15;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%'m0=1250.10 m1=225017.57 i2=41450.57'


p0=183567; 
i0=0.0241./12;
n0=12.*10;
[m0 m1 i2]=mrtg(p0, i0, n0); ['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%'m0=1722.98 m1=206757.83 i2=23190.83'



m0=(p0.*i0.*(1+i0).^n0)./((1+i0).^n0-1) % 1627.2
m1=n0*m0; %loan+interest total
i2= m1-p0  % total interest
%(i0/12)*p0
p1=m1; i1=[]; p2=[];
for k0=1:n0
    p1=[p1 p1(end)-m0]; %loan+interest remaining
    i1=p0(end).*i0; %interest payment
    p2=[p2 m0-i1(end)]; %loan payment
    p0=[p0 p0(end)-p2(end)]; %remaining loan
    %i1=(m0-p0(end).*i0)    
end

['m0=' n2s2(m0) ' m1=' n2s2(m1) ' i2=' n2s2(i2)]
%monthly payment total loan    interest


% clear all
% %% calculate loan repayments 201121
% 
% clr
% p0=90000; 
% i0=0.0325./12;
% n0=12.*5;
% %m0=1627.2 m1=97,632.0
% 
% clr
% p0=175000; 
% i0=0.0325./12;
% n0=12.*15;
% %m0=1,229.67 m1=221,340.66 m2=46,340.66
% 
% clr
% p0=1E6; 
% i0=0.03./12;
% n0=12.*30;
% %m0=4,216.04 m1=1,517,774.52 m2=517,774.52
% 
% clr
% p0=1E6; 
% i0=0.02./12;
% n0=12.*30;
% %m0=3,696.19 m1=1,330,630.10 m2=330,630.10
% 
% clr
% p0=1E6; 
% i0=0.01./12;
% n0=12.*30;
% %m0=3216.39 m1=1,157,902.27 m2=157,902.27
% 
% clr
% p0=150000; 
% i0=0.02./12;
% n0=36;
% %'m0=4296.38 m1=154669.92 i2=4669.92'
% 
% 
% clr
% p0=150000; 
% i0=0.022./12;
% n0=48;
% %'m0=3267.37 m1=156834.15 i2=6834.15'
% 
% clr
% p0=150000; 
% i0=0.0255./12;
% n0=60;
% %'m0=2665.41 m1=159924.75 i2=9924.75'
% 
% clr
% p0=150000; 
% i0=0.0295./12;
% n0=84; % number of months
% %'m0=1978.6166 m1=166203.7965 i2=16203.7965'
% 
% clr
% p0=90000; 
% i0=0.0255./12;
% n0=12.*5;
% %'m0=1599.2475 m1=95954.8508 i2=5954.8508'
% 
% m0=(p0.*i0.*(1+i0).^n0)./((1+i0).^n0-1) % 1627.2
% m1=n0*m0; %loan+interest total
% i2= m1-p0  % total interest
% %(i0/12)*p0
% p1=m1; i1=[]; p2=[];
% for k0=1:60
%     p1=[p1 p1(end)-m0]; %loan+interest remaining
%     i1=p0(end).*i0; %interest payment
%     p2=[p2 m0-i1(end)]; %loan payment
%     p0=[p0 p0(end)-p2(end)]; %remaining loan
%     %i1=(m0-p0(end).*i0)    
% end
% 
% ['m0=' n2s(m0) ' m1=' n2s(m1) ' i2=' n2s(i2)]